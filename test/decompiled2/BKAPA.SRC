DEFINE LIST_TERM_HNDL, I, 5
DEFINE BKSYTERM_HNDL, I, 5
DEFINE VEND_REC_HOLD, A, 1
DEFINE HOLD.VEND, A, 10
DEFINE FROM_BKARCREF, L, 3
DEFINE BKARCUST_HNDL, I, 5
DEFINE TYPE, I, 1
DEFINE OK, A, 1
DEFINE NEW_VEND, L, 3
DEFINE DSP_WCH, I, 5
DEFINE VENDCODE.HLDR, A, 10
DEFINE IN_BKPOA, L, 3
DEFINE VEND_REC_CHGD, L, 3
DEFINE MCNTR, I, 5
DEFINE MCNTR2, I, 5
DEFINE MCNTR3, I, 5
DEFINE MCNTR4, I, 5
DEFINE CHAIN_FRM, L, 3
DEFINE BKAPVEND_HNDL, I, 5
DEFINE BKAPVEND_CLBLV, R, 10
DEFINE BKAPADDR_CLBLV, R, 10
DEFINE BKAPCONT_CLBLV, R, 10
DEFINE READ_ONLY, L, 3
DEFINE BKSYS.AP.LOCK, A, 1
DEFINE BKAPADDR_HNDL, I, 5
DEFINE BKAPCONT_HNDL, I, 5
DEFINE BKAPRIVL_HNDL, I, 5
DEFINE BKAPINVL_HNDL, I, 5
DEFINE BKAPCHKH_HNDL, I, 5
DEFINE BKAPPO_HNDL, I, 5
DEFINE BKGLCOA_HNDL, I, 5
DEFINE BKSYMSTR_HNDL, I, 5
DEFINE BKAP.VENDCODE, A, 10
DEFINE BKAP.OUTINV, N(2), 12
DEFINE BKAP.OUT.CREDIT, N(2), 12
DEFINE BKAP.PURCH.YTD, N(2), 12
DEFINE BKAP.PURCH.LYR, N(2), 12
DEFINE BKAP.ACTIVE, A, 1
DEFINE BKAP.VENDNAME, A, 30
DEFINE BKAR.CUSTNAME, A, 30
DEFINE BKAP.ADD1, A, 30
DEFINE BKAR.ADD1, A, 30
DEFINE BKAP.ADD2, A, 30
DEFINE BKAR.ADD2, A, 30
DEFINE BKAP.CITY, A, 15
DEFINE BKAR.CITY, A, 15
DEFINE BKAP.STATE, A, 2
DEFINE BKAR.STATE, A, 2
DEFINE BKAP.ZIP, A, 10
DEFINE BKAR.ZIP, A, 10
DEFINE BKAP.COUNTRY, A, 30
DEFINE BKAP.CONTACT, A, 25
DEFINE BKAR.CONTACT, A, 25
DEFINE BKAP.TELEPHONE, A, 25
DEFINE BKAP.FAX.PHONE, A, 25
DEFINE BKAP.YOUR.ACCT, A, 25
DEFINE BKAP.COMMENTS1, A, 69
DEFINE BKAP.COMMENTS2, A, 69
DEFINE BKAP.CLASS, A, 2
DEFINE BKAP.START.DATE, D, 8
DEFINE BKAP.1099.TYPE, A, 1
DEFINE BKAP.1099.ID, A, 15
DEFINE BKAP.TERMS.NUM, I, 3
DEFINE BKSY.TERM.NUM, I, 3
DEFINE BKSY.TERM.USE, A, 1
DEFINE BKAP.DFLT.GLACT, A, 10
DEFINE BKAP.DFLT.GLDPT, A, 4
DEFINE BKSY.MSTR.VEND, A, 1
DEFINE BKSY.MSTR.VNUM, R, 10
DEFINE BKAP.NEW.VEND, A, 1
DEFINE BKAP.CONT.CODE, A, 10
DEFINE BKAP.ADDR.CODE, A, 10
DEFINE BKSYS.AP.F2, A, 1
DEFINE SG_WCH, A, 1
DEFINE BKSYS.GL.F2, A, 1
DEFINE BKAP.PO.NUM, R, 6
DEFINE BKAPHPO_HNDL, I, 5
DEFINE BKAPHPOL_HNDL, I, 5
DEFINE PO_LINE_PON, R, 6, 400
DEFINE PO_LINE_PROD, A, 15, 400
DEFINE PO_LINE_DATE, D, 8, 400
DEFINE PO_LINE_DESC, A, 30, 400
DEFINE PO_LINE_QTY, N(2), 8, 400
DEFINE PO_LINE_PRCE, N(4), 10, 400
DEFINE PO_LINE_EXT, N(2), 12, 400
DEFINE PO_LINE_CNTR, I, 5
DEFINE PO_LINE_YEAR, A, 1
DEFINE BKAP.PO.VNDCOD, A, 10
DEFINE BKAP.POL.PONM, R, 6
DEFINE BKAP.POL.ITYPE, A, 1
DEFINE BKAP.POL.ERD, D, 8
DEFINE BKAP.POL.PDESC, A, 30
DEFINE BKAP.POL.PPRCE, N(4), 10
DEFINE BKAP.POL.PDISC, N(2), 5
DEFINE BKAP.POL.PQTY, N(2), 8
DEFINE BKAP.POL.PEXT, N(2), 12
DEFINE BKAP.POL.PCODE, A, 15
DEFINE POH_TTL1, A, 110
DEFINE POH_USCORE, A, 110
DEFINE CPRICE_BASE, N(4), 14
DEFINE CPRICE_DISC, N(4), 8
DEFINE FROM_DATE1, D, 8
DEFINE THRU_DATE1, D, 8
DEFINE FROM_DATE2, D, 8
DEFINE THRU_DATE2, D, 8
DEFINE FROM_DATE3, D, 8
DEFINE THRU_DATE3, D, 8
DEFINE FROM_DATE4, D, 8
DEFINE THRU_DATE4, D, 8
DEFINE PURCH_QTY1, I, 3
DEFINE PURCH_QTY2, I, 3
DEFINE PURCH_QTY3, I, 3
DEFINE PURCH_QTY4, I, 3
DEFINE AVG_PURCH1, N(2), 10
DEFINE AVG_PURCH2, N(2), 10
DEFINE AVG_PURCH3, N(2), 10
DEFINE AVG_PURCH4, N(2), 10
DEFINE PURCH_TOT_DOL1, N(2), 12
DEFINE PURCH_TOT_DOL2, N(2), 12
DEFINE PURCH_TOT_DOL3, N(2), 12
DEFINE PURCH_TOT_DOL4, N(2), 12
DEFINE ALL_PURCH_QTY, I, 3
DEFINE AVG_TOT_PURCH, N(2), 10
DEFINE ALL_PURCH_DOL, N(2), 12
DEFINE BKAPAPRC_HNDL, I, 5
DEFINE BKAP.PO.ORDDTE, D, 8
DEFINE BKAP.PO.SUBTOT, N(2), 12
DEFINE PAGE_NUM, I, 5
DEFINE DATE_TIME_FLD, A, 28
DEFINE GROSS_MTD_SUBT, N(2), 12
DEFINE GROSS_TOTALS, N(2), 12
DEFINE PURCH.MTD, N(2), 12
DEFINE YEAR_LONG, A, 10
DEFINE YEAR_SHORT, A, 4
DEFINE FOUND_PRCH, L, 3
DEFINE MONTH, A, 3
DEFINE NAME_HLDR, A, 25
DEFINE MONTHS, A, 36
DEFINE GROSS_PRCH_AMT, N(2), 12, 60
DEFINE YEAR_ARRAY, A, 4, 5
DEFINE BKAPAP2_HLL, R, 10, 20
DEFINE BKAPAP2_PHCNTR, I, 5
DEFINE BKAPAP2_PHRET, L, 3
DEFINE BKAPAPO_TTL1, A, 367
DEFINE BKAPAPO_USCORE, A, 367
DEFINE BKAP.PO.DESC, A, 30
DEFINE BKAP.PO.TOTAL, N(2), 12
DEFINE BKAP.PO.SHPCOD, A, 10
DEFINE BKAP.PO.SHPNME, A, 30
DEFINE BKAP.PO.SHPA1, A, 30
DEFINE BKAP.PO.SHPA2, A, 30
DEFINE BKAP.PO.SHPCTY, A, 15
DEFINE BKAP.PO.SHPST, A, 2
DEFINE BKAP.PO.SHPZIP, A, 10
DEFINE BKAP.PO.TERMD, A, 10
DEFINE BKAP.PO.ENTBY, A, 5
DEFINE BKAP.PO.OBYCUS, A, 10
DEFINE BKAP.PO.TAXABLE, A, 1
DEFINE BKAP.PO.TAXRTE, N(2), 5
DEFINE BKAP.PO.TAXAMT, N(2), 8
DEFINE BKAP.PO.RNI.D, N(2), 12
DEFINE BKAP.PO.PRTD, A, 1
DEFINE BKAPAHPO_TTL1, A, 367
DEFINE BKAPAHPO_USCORE, A, 367
DEFINE BKAPADDR_TTL1, A, 241
DEFINE BKAPADDR_USCORE, A, 241
DEFINE BKAP.ADDR.NAME, A, 30
DEFINE BKAP.ADDR.ADD1, A, 30
DEFINE BKAP.ADDR.ADD2, A, 30
DEFINE BKAP.ADDR.CITY, A, 15
DEFINE BKAP.ADDR.STATE, A, 2
DEFINE BKAP.ADDR.ZIP, A, 10
DEFINE BKAP.ADDR.COM, A, 25
DEFINE BKAP.ADDR.CNTRY, A, 30
DEFINE VENDCONT_TTL1, A, 124
DEFINE VENDCONT_USCORE, A, 124
DEFINE BKAP.CONT.NAME, A, 25
DEFINE BKAP.CONT.LOC, A, 25
DEFINE BKAP.CONT.PHONE, A, 25
DEFINE BKAP.CONT.FAX, A, 25
DEFINE HPOFILE, A, 8
DEFINE HPOLFILE, A, 8
DEFINE APVOUCH_TTL1, A, 110
DEFINE APVOUCH_USCORE, A, 110
DEFINE BKAP.INVL.DATE, D, 8
DEFINE BKAP.INVL.DUEDT, D, 8
DEFINE BKAP.INVL.NUM, A, 10
DEFINE BKAP.INVL.DESC, A, 25
DEFINE BKAP.INVL.TYPED, A, 10
DEFINE BKAP.INVL.TAMT, N(2), 13
DEFINE BKAP.INVL.CODE, A, 10
DEFINE CHKH_TTL1, A, 130
DEFINE CHKH_USCORE, A, 130
DEFINE BKAP.CHK.CHKDTE, D, 8
DEFINE BKAP.CHK.INVDTE, D, 8
DEFINE BKAP.CHK.INVNUM, A, 10
DEFINE BKAP.CHK.DESC, A, 25
DEFINE BKAP.CHK.NUM, R, 6
DEFINE BKAP.CHK.CHKACT, I, 3
DEFINE BKAP.CHK.INVAMT, N(2), 12
DEFINE BKAP.CHK.AMTPD, N(2), 12
DEFINE BKAP.CHK.VNDCOD, A, 10
DEFINE RRAP_TTL1, A, 110
DEFINE RRAP_USCORE, A, 110
DEFINE BKAP.INVL.TERMD, A, 10
DEFINE BKAP.LASTPURCH, D, 8
DEFINE BKAP.LASTPMT, D, 8
DEFINE LIST_VEND_KEY, I, 5
DEFINE LIST_VEND_HNDL, I, 5
DEFINE VENDNORM_TTL1, A, 156
DEFINE VENDNORM_USCORE, A, 156
DEFINE LIST_GLCOA_KEY, I, 5
DEFINE LIST_GLCOA_HNDL, I, 5
DEFINE LIST_GLCOA_TYPE, A, 1
DEFINE GLCAF2_TTL1, A, 72
DEFINE GLCAF2_USCORE, A, 72
DEFINE BKGL.TYPE, A, 1
DEFINE BKGL.ACCTD, A, 25
DEFINE BKGL.ACTIVE, A, 1
DEFINE LOGON_CODE, A, 15
DEFINE BKSYMSTS_HNDL, I, 5
DEFINE LIST_TERM_KEY, I, 5
DEFINE LIST_TERM_FROM, A, 1
DEFINE TERMNORM_TTL1, A, 128
DEFINE TERMNORM_USCORE, A, 128
DEFINE BKSY.TERM.DESC, A, 10
DEFINE BKSY.TERM.DAMT, N(2), 5
DEFINE BKSY.TERM.TYP, A, 1
DEFINE BKSY.TERM.DAYS, I, 3
DEFINE BKSY.TERM.MAX, I, 3
DEFINE BKSY.TERM.CALC, A, 1
DEFINE FILELOC_HNDL, I, 5
DEFINE LISTFILE_TTL1, A, 80
DEFINE LISTFILE_USCORE, A, 80
DEFINE LOC_BUFF_NAME, A, 8
DEFINE LOC_FILE_NAME, A, 8
DEFINE LOC_DESCRIPTION, A, 40

LABEL_6
LABEL_1:
COLOR
TRAP f2,f3,f4,f5,f6,f7,f8,f9,f10 IGNR
   IF .NOT. LABEL_61() THEN
QUIT
OPENV 'bksyterm', N, BKSYTERM_HNDL
   IF .NOT. LABEL_62() THEN
QUIT
PARAM BKAPVEND_HNDL
TRAP RT_A GOTO LABEL_63
GETLBL LABEL_64, BKAPVEND_CLBLV
GETLBL LABEL_65, BKAPADDR_CLBLV
GETLBL LABEL_66, BKAPCONT_CLBLV
READ_ONLY = .F.
IF (BKAPVEND_HNDL=0) .AND. BKSYS.AP.LOCK='Y'
   ASK 'Look at vendor information only? Y'
   IF ASK()
      OPENV 'bkapvend', N, BKAPVEND_HNDL
      OPENV 'bkapaddr', N, BKAPADDR_HNDL
      OPENV 'bkapcont', N, BKAPCONT_HNDL
      READ_ONLY = .T.
      GOTO LABEL_67
   ENDIF
ENDIF
IF BKAPVEND_HNDL<>0
LABEL_2:
   ROPEN BKAPVEND_HNDL
   CHAIN_FRM = .T.
ELSE
   OPENV 'bkapvend', R, BKAPVEND_HNDL
ENDIF
OPENV 'bkapaddr', R, BKAPADDR_HNDL
LABEL_3:
OPENV 'bkapcont', R, BKAPCONT_HNDL
IF FROM_BKARCREF
LABEL_4:
   IF BKARCUST_HNDL=0
      MSG 'Unable to find customer file handle.', NOWAIT
LABEL_5:
   ELSE
      ROPEN BKARCUST_HNDL
   ENDIF
ENDIF
OPENV 'bkaprivl', N, BKAPRIVL_HNDL
OPENV 'bkapinvl', N, BKAPINVL_HNDL
OPENV 'bkapchkh', N, BKAPCHKH_HNDL
OPENV 'bkappo', N, BKAPPO_HNDL
OPENV 'bkglcoa', N, BKGLCOA_HNDL
IF READ_ONLY
   OPENV 'BKSYMSTR', N, BKSYMSTR_HNDL
ELSE
   OPENV 'BKSYMSTR', R, BKSYMSTR_HNDL
   FIELD[278] = .F.
   IF .NOT. CHAIN_FRM
      DALL BKAPVEND_HNDL, 1, ''
      CLR BKAPVEND_HNDL
   ENDIF
ENDIF
FINDV F, BKSYMSTR_HNDL, 44761343, LABEL_0, NLOCK
   IF FLERR(BKSYMSTR_HNDL)<>0 THEN
GOTO LABEL_68
FIELD[82] = 'BKAPA'
TRAP ESC GOTO LABEL_68
TRAP f5,f6,f7,f8,f9 DFLT
FORMAT BKAP.OUTINV
FORMAT BKAP.OUT.CREDIT
FORMAT BKAP.PURCH.YTD
FORMAT BKAP.PURCH.LYR
MOUNT SCREEN
IF .NOT. READ_ONLY
   LABEL_39 'Enter/Change Vendor Information'
LABEL_8:
ELSE
   LABEL_39 'View Vendor Information'
ENDIF
LABEL_45 'Vendor', 'AP', FFLD('bkap.vendcode','p')
PMSG 'Recs: ', TRIM(STR(TRC(BKAPVEND_HNDL)),'L') AT 55,2 NOCR PTW S
UPAR LABEL_0
LABEL_9:
NEW_VEND = .F.
TRAP f3,f4,f5,f6,f7,f8,f9,PG_DN DFLT
PMSG CCF(), 'ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ', CCF() AT 32,2
LABEL_10:
IF .NOT. CHAIN_FRM
   CLR BKAPVEND_HNDL
   ENTER BKAP.VENDCODE, PRE=LABEL_70()
      IF BKAP.VENDCODE='' GOTO LABEL_71
   FIELD[275] = .T.
   FINDV M, BKAPVEND_HNDL, 1, LABEL_71, NOCLR
   FIELD[275] = .F.
   LABEL_29 'F1 Help,F3 Clr Rec,F4 Del Rec,PgDn Vendor Options,F10 Save', 'ESC Exit'
   TRAP f4 GOTO LABEL_72
   TRAP f3 GOTO LABEL_73
ELSE
   LABEL_29 'F1 Help,PgDn Vendor Options,F10 Save', 'ESC Exit'
ENDIF
TRAP PG_DN GOSUB LABEL_74
LABEL_12:
GOTO LABEL_75
IF READ_ONLY
   TRAP f2,f3,f4,f5,f6,f7,f8,f9,f10 IGNR
   IF FLERR(BKAPVEND_HNDL)<>0
      MSG 'You must input a valid vendor code.', NOWAIT
      GOTO LABEL_69
   ENDIF
ENDIF
FIELD[275] = .F.
PMSG CCF(), 'µ', CCR(), '  NEW VENDOR  ', CCF(), 'Æ', CCF() AT 32,2
VENDCODE.HLDR = BKAP.VENDCODE
FINDV M, BKAPVEND_HNDL, 1, 'DEFAULT   ', LABEL_0
LABEL_13:
CLR BKAPVEND_HNDL
BKAP.VENDCODE = VENDCODE.HLDR
BKAP.ACTIVE = 'Y'
NEW_VEND = .T.
IF .NOT. CHAIN_FRM
LABEL_14:
   LABEL_29 'F1 Help,F3 Clr Record,PgDn Vendor Options,F10 Save', 'ESC Exit'
ELSE
   LABEL_29 'F1 Help,PgDn Vendor Options,F10 Save', 'ESC Exit'
ENDIF
TRAP f5,f6,f7,f8,f9 IGNR
TRAP f10 GOTO LABEL_76
TRAP f2 IGNR
   IF READ_ONLY THEN
TRAP f10 IGNR
LABEL_15:
IF .NOT. CHAIN_FRM .AND. .NOT. READ_ONLY
   ENTER BKAP.ACTIVE, 'YN', DFLT='Y'
   {
      FIELD[86][1] = ' Enter 'N' to make this vendor non-selectable in'
      FIELD[86][2] = ' certain programs; otherwise, enter 'Y' to make this'
      FIELD[86][3] = ' vendor fully active.'
      LABEL_17 FIELD[87], 3
      RET
LABEL_17:
   }
ENDIF
ENTER BKAP.VENDNAME, PRE=LABEL_78(), POST=LABEL_79(), DFLT=IIF(FROM_BKARCREF,BKAR.CUSTNAME,'')
IF READ_ONLY
   IF WINDOWS()
LABEL_18:
      MSG 'Click on OK or press ENTER to continue.', NOWAIT
   ELSE
      MSG 'Press a key to continue.', NOWAIT
   ENDIF
   GOTO LABEL_69
ENDIF
LABEL_19:
ENTER BKAP.ADD1, DFLT=IIF(FROM_BKARCREF,BKAR.ADD1,'')
ENTER BKAP.ADD2, DFLT=IIF(FROM_BKARCREF,BKAR.ADD2,'')
ENTER BKAP.CITY, PRE=LABEL_78(), POST=LABEL_79(), DFLT=IIF(FROM_BKARCREF,BKAR.CITY,'')
ENTER BKAP.STATE, PRE=LABEL_78(), POST=LABEL_79(), DFLT=IIF(FROM_BKARCREF,BKAR.STATE,'')
LABEL_20:
ENTER BKAP.ZIP, PRE=LABEL_78(), POST=LABEL_79(), DFLT=IIF(FROM_BKARCREF,BKAR.ZIP,'')
ENTER BKAP.COUNTRY
ENTER BKAP.CONTACT, DFLT=IIF(FROM_BKARCREF,BKAR.CONTACT,'')
ENTER BKAP.TELEPHONE
LABEL_16:
ENTER BKAP.FAX.PHONE
ENTER BKAP.YOUR.ACCT
ENTER BKAP.COMMENTS1
ENTER BKAP.COMMENTS2
ENTER BKAP.CLASS
ENTER BKAP.START.DATE, DFLT=DATE()
ENTER BKAP.1099.TYPE, LABEL_82(), PRE=LABEL_80(), POST=LABEL_81()
{
   FUNC LABEL_80
   TRAP f2 GOSUB LABEL_83
   LABEL_29 'F2 Display 1099 Types', 'ESC Exit'
   RET
   FUNC LABEL_81
   TRAP f2 DFLT
   IF .NOT. CHAIN_FRM
      LABEL_29 'F1 Help,F3 Clr Record,PgDn Vendor Options,F10 Save', 'ESC Exit'
   ELSE
      LABEL_29 'F1 Help,PgDn Vendor Options,F10 Save', 'ESC Exit'
   ENDIF
   RET
   FUNC LABEL_82
   IF BKAP.1099.TYPE=''
      RET
   ELSE
      IF BKAP.1099.TYPE='1'
         RET
      ELSE
         IF BKAP.1099.TYPE='2'
            RET
         ELSE
            IF BKAP.1099.TYPE='3'
               RET
            ELSE
               IF BKAP.1099.TYPE='4'
                  RET
               ELSE
                  IF BKAP.1099.TYPE='5'
                     RET
                  ELSE
                     IF BKAP.1099.TYPE='6'
                        RET
                     ELSE
                        IF BKAP.1099.TYPE='7'
                           RET
                        ELSE
LABEL_21:
                           IF BKAP.1099.TYPE='8'
                              RET
                           ENDIF
                        ENDIF
                     ENDIF
                  ENDIF
               ENDIF
            ENDIF
         ENDIF
      ENDIF
   ENDIF
   NOVLDMSG
   MSG 'Please choose a valid option. Press F2 to list the options.', NOWAIT
   RET
   FIELD[86][1] = ' 1 - Rents'
   FIELD[86][2] = ' 2 - Royalties'
   FIELD[86][3] = ' 3 - Other income'
   FIELD[86][4] = ' 4 - Fishing Boat Proceeds'
   FIELD[86][5] = ' 5 - Medical and Health Care Payments'
   FIELD[86][6] = ' 6 - Nonemployee Compensation'
   FIELD[86][7] = ' 7 - Subst Pmts for dividends/interest'
   FIELD[86][8] = ' 8 - Crop Insurance Proceeds'
   NMENU FIELD[86], 30, 15, 41, 8, '1099 Types', TYPE
   IF TYPE=0
      BKAP.1099.TYPE = ''
   ELSE
      IF TYPE=1
         BKAP.1099.TYPE = '1'
      ELSE
         IF TYPE=2
            BKAP.1099.TYPE = '2'
         ELSE
            IF TYPE=3
               BKAP.1099.TYPE = '3'
            ELSE
               IF TYPE=4
                  BKAP.1099.TYPE = '4'
               ELSE
                  IF TYPE=5
                     BKAP.1099.TYPE = '5'
                  ELSE
                     IF TYPE=6
                        BKAP.1099.TYPE = '6'
                     ELSE
                        IF TYPE=7
                           BKAP.1099.TYPE = '7'
                        ELSE
                           IF TYPE=8
                              BKAP.1099.TYPE = '8'
                           ENDIF
                        ENDIF
                     ENDIF
                  ENDIF
               ENDIF
            ENDIF
         ENDIF
      ENDIF
   ENDIF
   RET
}
ENTER BKAP.1099.ID
ENTER BKAP.TERMS.NUM, LABEL_86(), PRE=LABEL_84(), POST=LABEL_85(), DFLT=BKAP.TERMS.NUM, VMSG='You must enter a valid terms number.'
{
   FUNC LABEL_84
   LABEL_29 'F1 Help,F2 Terms,F3 Clr Record,F10 Save', 'ESC Exit'
   TRAP f2 GOSUB LABEL_87
   RET
}
{
LABEL_7:
   FUNC LABEL_85
   LABEL_29 'F1 Help,F3 Clr Record,F10 Save', 'ESC Exit'
   TRAP f2 IGNR
   RET
}
{
LABEL_22:
      IF LABEL_88(1,BKSYTERM_HNDL,'P')<>0 THEN
   BKAP.TERMS.NUM = BKSY.TERM.NUM
   RET
}
{
   FUNC LABEL_86
   FINDV M, BKSYTERM_HNDL, 1, BKAP.TERMS.NUM, LABEL_0
      IF FLERR(BKSYTERM_HNDL)<>0 THEN
LABEL_23:
   RET
      IF BKSY.TERM.USE='R' RET
   RET
}
ENTER BKAP.DFLT.GLACT, PRE=LABEL_89('A'), POST=LABEL_90()
ENTER BKAP.DFLT.GLDPT, LABEL_91(), PRE=LABEL_89('D'), POST=LABEL_90()
   IF READ_ONLY GOTO LABEL_69
IF BKAP.VENDCODE=''
   IF BKSY.MSTR.VEND='T'
      FIELD[86][1] = BKAP.TELEPHONE
      FIELD[35] = 1
      WHILE FIELD[35]<=SIZE(FIELD[86][1],'a')
LABEL_25:
         OK = MID(FIELD[86][1],FIELD[35],1)
         IF .NOT. ISNUM(OK)
            DELC FIELD[86][1], FIELD[35], 1
         ENDW
      ENDIF
      INC FIELD[35]
   ENDW
   BKAP.VENDCODE = FIELD[86][1]
ELSE
   IF BKSY.MSTR.VEND='S'
      PUSHT
      TRAP RT_A IGNR
      FINDV F, BKSYMSTR_HNDL, 44761343, LABEL_0
      BKAP.VENDCODE = JUST(STR(BKSY.MSTR.VNUM),'l')
      WHILE .T.
         IFDUP ?0x01:21
         INC BKSY.MSTR.VNUM
         BKAP.VENDCODE = JUST(STR(BKSY.MSTR.VNUM),'l')
      ENDW
   ELSE
   ENDW
LABEL_26:
   INC BKSY.MSTR.VNUM
   SAVE BKSYMSTR_HNDL, LABEL_0
   CLR BKSYMSTR_HNDL
   POPT
ELSE
   GOSUB LABEL_92
ENDIF
ENDIF
ENDIF
IF BKAP.VENDCODE=''
   FIELD[86][1] = ' You must assign this vendor a CODE'
   FIELD[86][2] = ' before this record can be saved'
   LABEL_17 FIELD[87], 2
   GOTO LABEL_71
ENDIF
ASK 'Do you want to save this Vendor record? [Y/N] Y'
   IF .NOT. ASK() GOTO LABEL_75
IF NEW_VEND
   HOLD.VEND = BKAP.VENDCODE
   ALLOC VEND_REC_HOLD, 'A', RSIZE(BKAPVEND_HNDL)
   XFER BKAP.VENDCODE, VEND_REC_HOLD, RSIZE(BKAPVEND_HNDL)
   SAVES
   FINDV M, BKAPVEND_HNDL, 1, HOLD.VEND, LABEL_0, NLOCK
   IF FLERR()=0
      MSG 'You have tried to enter a Vendor that has already been entered.  Another user may have just entered a Vendor with this Vendor code. ', NOWAIT
      WINDOW 20, 12, 3, 40, FIELD[37], 'd', 'r'
      PMSG ' Enter a valid Vendor ' AT 2,1 NOCR
LABEL_27:
      UPAR LABEL_0
      ENTER 26, 1, HOLD.VEND, LABEL_93()
      {
         FUNC LABEL_93
         FINDV M, BKAPVEND_HNDL, 1, HOLD.VEND, LABEL_0, NLOCK
         IF FLERR()=0
            MSG 'This Vendor already exists! Please enter one that doesn't exist. ', NOWAIT
            NOVLDMSG
            RET
         ENDIF
         RET
      }
   ENDIF
   XFER VEND_REC_HOLD, BKAP.VENDCODE, RSIZE(BKAPVEND_HNDL)
   BKAP.VENDCODE = HOLD.VEND
   REDSP
   SCRN
   ALLOC VEND_REC_HOLD, 'A', 1
ENDIF
BKAP.NEW.VEND = 'Y'
IF CHAIN_FRM
   VEND_REC_CHGD = REC_CHANGED(BKAPVEND_HNDL)
   SAVE BKAPVEND_HNDL, LABEL_0
   QUIT
ENDIF
IF NEW_VEND
   VENDCODE.HLDR = BKAP.VENDCODE
   SAVE BKAPVEND_HNDL, LABEL_0
   FIELD[86][1] = ' Do you want to enter a P/O for this vendor now? [Y/N]'
   OK = LABEL_22(FIELD[87],1,'N','YN')
ELSE
   OK = 'N'
ENDIF
LABEL_29:
CLR BKAPPO_HNDL
IF OK='Y'
   NEW_VEND = LABEL_94()
ELSE
   IF .NOT. NEW_VEND
      VENDCODE.HLDR = BKAP.VENDCODE
      SAVE BKAPVEND_HNDL, LABEL_0
   ELSE
      ASK 'Would you like to work with the vendor options menu for new vendor '+' '+TRIM(VENDCODE.HLDR,'t')+' ? Y'
      IF ASK()
         FINDV M, BKAPVEND_HNDL, 1, VENDCODE.HLDR, LABEL_0
         GOSUB LABEL_74
      ENDIF
   ENDIF
ENDIF
GOTO LABEL_69
   IF READ_ONLY GOTO LABEL_69
IF BKAP.OUTINV<>0
   FIELD[86][1] = ' You may not delete a Vendor record that has an outstanding balance.'
   LABEL_17 FIELD[87], 1
   GOTO LABEL_75
ENDIF
IF BKAP.OUT.CREDIT<>0
   FIELD[86][1] = ' You may not delete this Vendor record'
   FIELD[86][2] = ' because there are unapplied credit amounts.'
   LABEL_17 FIELD[87], 2
   BKAP.VENDCODE = VENDCODE.HLDR
   GOTO LABEL_75
ENDIF
ASK 'Do you want to delete this Vendor record? [Y/N] Y'
   IF .NOT. ASK() GOTO LABEL_75
DALL BKAPCONT_HNDL, 1, BKAP.VENDCODE
DALL BKAPADDR_HNDL, 1, BKAP.VENDCODE
CLR BKAPADDR_HNDL
CLR BKAPCONT_HNDL
DEL BKAPVEND_HNDL
GOTO LABEL_69
GOTO LABEL_69
VEND_REC_CHGD = .F.
CLR BKAPVEND_HNDL
QUIT
FIELD[275] = .T.
VEND_REC_CHGD = .F.
CLR BKAPVEND_HNDL
QUIT
FUNC LABEL_70
LABEL_29 'F1 Help,F2 Display Vendors,F3 Clear Record', 'ESC Exit'
TRAP f2 GOSUB LABEL_95
TRAP f10 IGNR
RET
IF BKSYS.AP.F2='N'
   BKAP.VENDCODE = LABEL_96(4,BKAPVEND_HNDL)
ELSE
   BKAP.VENDCODE = LABEL_96(1,BKAPVEND_HNDL)
ENDIF
RET
FUNC LABEL_78
   IF CHAIN_FRM THEN
RET
TRAP f5,f6,f7,f8,f9 DFLT
RET
FUNC LABEL_79
TRAP f5,f6,f7,f8,f9 IGNR
RET
BKAP.TERMS.NUM = LABEL_28(BKAP.TERMS.NUM)
LABEL_30:
SCRN
RET
FUNC LABEL_89(SG_WCH)
   IF (SG_WCH='D') .AND. BKAP.DFLT.GLACT='' THEN
RET
LABEL_29 'F1 Help,F2 Display G/L Accounts,F10 Save', 'ESC Exit'
TRAP f2 GOSUB LABEL_98
RET
FUNC LABEL_90
IF .NOT. CHAIN_FRM
   IF .NOT. IFNA(BKAPVEND_HNDL)
LABEL_24:
      LABEL_29 'F1 Help,F3 Clr Rec,F4 Del Rec,PgDn Vendor Options,F10 Save', 'ESC Exit'
   ELSE
      LABEL_29 'F1 Help,F3 Clr Record,PgDn Vendor Options,F10 Save', 'ESC Exit'
   ENDIF
ELSE
   LABEL_29 'F1 Help,PgDn Vendor Options,F10 Save', 'ESC Exit'
ENDIF
TRAP f2 DFLT
RET
FUNC LABEL_91
   IF BKAP.DFLT.GLACT='' THEN
RET
FIELD[152] = BKAP.DFLT.GLACT
FIELD[153] = BKAP.DFLT.GLDPT
FINDV M, BKGLCOA_HNDL, 2, LABEL_0
IF FIELD[152]=''
   FIELD[86][1] = 'The G/L Account-Department entered was not found.'
   FIELD[86][2] = 'You may use F2 for a menu of the Chart of Accounts.'
   LABEL_17 FIELD[87], 2
   NOVLDMSG
   RET
ENDIF
   IF .NOT. LABEL_99() THEN
RET
RET
IF BKSYS.GL.F2='N'
   IF LABEL_100(3,BKGLCOA_HNDL)<>''
      BKAP.DFLT.GLACT = FIELD[152]
      BKAP.DFLT.GLDPT = FIELD[153]
   ENDIF
ELSE
   IF LABEL_100(1,BKGLCOA_HNDL)<>''
      BKAP.DFLT.GLACT = FIELD[152]
      BKAP.DFLT.GLDPT = FIELD[153]
   ENDIF
ENDIF
RET
FIELD[86][1] = BKAP.VENDNAME
MCNTR2 = 25
MCNTR3 = 6
GOSUB LABEL_101
BKAP.VENDCODE = FIELD[86][2]
FIELD[86][1] = BKAP.STATE
MCNTR2 = 2
MCNTR3 = 2
GOSUB LABEL_101
BKAP.VENDCODE = BKAP.VENDCODE+FIELD[86][2]
LABEL_31:
FIELD[86][1] = BKAP.CITY
MCNTR2 = 15
MCNTR3 = 2
GOSUB LABEL_101
BKAP.VENDCODE = BKAP.VENDCODE+FIELD[86][2]
BKAP.VENDCODE = UP(BKAP.VENDCODE)
RET
FIELD[86][2] = ''
MCNTR4 = 0
MCNTR = 1
ENDW
FOR MCNTR = ; MCNTR2
      IF MCNTR4>=MCNTR3 RET
   OK = MID(FIELD[86][1],MCNTR,1)
      IF OK='.' THEN
   OK = ''
      IF OK=''' THEN
   OK = ''
      IF OK='-' THEN
   OK = ''
      IF OK='/' THEN
   OK = ''
      IF OK='\' THEN
   OK = ''
      IF OK='&' THEN
   OK = ''
      IF OK=' ' THEN
   OK = ''
   IF OK<>''
      FIELD[86][2] = FIELD[86][2]+OK
      MCNTR4 = MCNTR4+1
   ENDIF
ENDW
NEXT
RET
SAVES
LABEL_13
LABEL_29 '', 'ESC Exit'
GOSUB LABEL_102
LABEL_33:
LABEL_14
REDSP
RET
NMENU ' 1 - Current P/O's ', ' 2 - P/O History ', ' 3 - Aging ', ' 4 - Purch by Date Range ', ' 5 - Purch by Month ', ' 6 - P/O Lines ', ' V - Vouchers ', ' C - Check History ', ' R - Recurring Vouchers ', '--', ' 7 - Alternate Addresses ', ' 8 - Alternate Contacts ', 26, 10, 28, ' Vendor Options ', DSP_WCH
   IF DSP_WCH=0 RET
SELECT DSP_WCH
CASE 1
   GOSUB LABEL_103
CASE 2
   GOSUB LABEL_104
   GOSUB LABEL_105
LABEL_6:
   GOSUB LABEL_106
CASE 3
   GOSUB LABEL_107
LABEL_34:
CASE 4
   GOSUB LABEL_104
   GOSUB LABEL_108
   GOSUB LABEL_106
CASE 5
   GOSUB LABEL_104
   GOSUB LABEL_109
   GOSUB LABEL_106
CASE 6
   GOSUB LABEL_104
LABEL_35:
   GOSUB LABEL_110
   GOSUB LABEL_106
CASE 7
LABEL_28:
   GOSUB LABEL_111
CASE 8
   GOSUB LABEL_112
CASE 9
   GOSUB LABEL_113
CASE 10
   GOSUB LABEL_114
CASE 11
   GOSUB LABEL_115
ENDC
GOTO LABEL_102
IF FIELD[205][61]='Y'
   SAVES
   CHAIN FIELD[81]+'bkapg'
   REDSP
ELSE
   MSG 'You do not have security level access to enter this program.', NOWAIT
ENDIF
RET
FUNC LABEL_94
IF ETYP()='D'
   BELL
   RET
ENDIF
IF IN_BKPOA
   FIELD[86][1] = ' You're already in the P/O Program and can't chain to it again.'
   LABEL_17 FIELD[87], 1
   RET
ENDIF
IF FIELD[205][73]='N'
   MSG 'You do not have security level access to enter this program.', NOWAIT
   RET
ENDIF
SAVES
LABEL_36:
VENDCODE.HLDR = BKAP.VENDCODE
   IF .NOT. READ_ONLY THEN
SAVE BKAPVEND_HNDL, LABEL_0
CHAIN FIELD[81]+'bkpoa'
REDSP
FINDV M, BKAPVEND_HNDL, 1, VENDCODE.HLDR, LABEL_0
FINDV M, BKAPPO_HNDL, 3, BKAP.VENDCODE, LABEL_0
IF FLERR(BKAPPO_HNDL)<>0
   LIST_EXIT
ELSE
   RDLIST
ENDIF
CLR BKAPPO_HNDL
RET
FUNC LABEL_116
IF ETYP()='D'
   BELL
   RET
ENDIF
LABEL_11:
IF FIELD[205][77]='Y'
   SAVES
   CHAIN FIELD[81]+'bkpoe'
   REDSP
ELSE
   MSG 'You do not have security level access to enter this program.', NOWAIT
ENDIF
RET
FUNC LABEL_117
IF ETYP()='D'
   BELL
   RET
ENDIF
IF FIELD[205][77]='Y'
   SAVES
   CHAIN FIELD[81]+'bkpoe'
   REDSP
ELSE
   MSG 'You do not have security level access to enter this program.', NOWAIT
ENDIF
RET
FIELD[86][1] = ' Limit search to this year only? '
PO_LINE_YEAR = LABEL_22(FIELD[87],1,'N','YN')
SAVES
UPDTA PO_LINE_DATE, PO_LINE_PON, PO_LINE_DESC, PO_LINE_QTY, PO_LINE_EXT, PO_LINE_PRCE, PO_LINE_PROD, CLR
MSG 'Please wait, checking received p/o's...', NOWAIT
PO_LINE_CNTR = 0
SCAN BKAPHPO_HNDL, 5, BKAP.VENDCODE
   SCAN BKAPHPOL_HNDL, 1, BKAP.PO.NUM, (UP(BKAP.POL.ITYPE)<>'X') .AND. IIF(PO_LINE_YEAR='Y',BKAP.POL.ERD>=FIELD[120],.T.), BKAP.PO.NUM=BKAP.POL.PONM, 78
      INC PO_LINE_CNTR
      PO_LINE_DATE[PO_LINE_CNTR] = BKAP.POL.ERD
      PO_LINE_PON[PO_LINE_CNTR] = BKAP.POL.PONM
      PO_LINE_DESC[PO_LINE_CNTR] = BKAP.POL.PDESC
      PO_LINE_PRCE[PO_LINE_CNTR] = LABEL_118(BKAP.POL.PPRCE,BKAP.POL.PDISC)
      PO_LINE_QTY[PO_LINE_CNTR] = BKAP.POL.PQTY
      PO_LINE_EXT[PO_LINE_CNTR] = BKAP.POL.PEXT
      PO_LINE_PROD[PO_LINE_CNTR] = BKAP.POL.PCODE
      IF PO_LINE_CNTR=400
         FIELD[86][1] = ' There are more line items than will fit in the array.'
         FIELD[86][2] = ' You need to either limit the search to this year or '
LABEL_37:
         FIELD[86][3] = ' display the p/o's using option 2 in this menu.'
         LABEL_17 FIELD[87], 3
      ELSE
      ENDS
   ENDIF
   EXIT_IF PO_LINE_CNTR=400
ENDS
IF PO_LINE_CNTR=0
   REDSP
   FIELD[86][1] = ' There are no applicable history line items for this vendor.'
   LABEL_17 FIELD[87], 1
   RET
ENDIF
LABEL_13
IF WINDOWS()
   WINDOW 2, 15, 10, 78, FIELD[37], ' Received Line Items for this Vendor ', 'L', 'S', 'R'
ELSE
   WINDOW 1, 15, 10, 80, FIELD[37], ' Received Line Items for this Vendor ', 'L', 'S', 'R'
ENDIF
LABEL_29 'Move cursor to view', 'ESC Exit'
SETLINE POH_TTL1, 'Date    ', 'P/O # ', 'Product Code   ', 'Product Description           ', 'Net Price ', 'Qty Prch', 'Tot Line Amt'
SETLINE POH_USCORE, 'ÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄÄ'
LISTM PO_LINE_DATE, PO_LINE_PON, PO_LINE_PROD, PO_LINE_DESC, PO_LINE_PRCE, PO_LINE_QTY, PO_LINE_EXT, FIELD[35], PO_LINE_CNTR
LABEL_38:
LABEL_14
SCRN
REDSP
RET
FUNC LABEL_118(CPRICE_BASE, CPRICE_DISC)
IF CPRICE_DISC=0
LABEL_39:
   RET
ELSE
   IF CPRICE_DISC<100
      RET
   ELSE
      RET
   ENDIF
ENDIF
OPENV 'bkapaprc.dat', N, BKAPAPRC_HNDL, 32, FROM_DATE1
READ BKAPAPRC_HNDL, 32
CLOSE BKAPAPRC_HNDL
FORMAT PURCH_TOT_DOL1
FORMAT PURCH_TOT_DOL2
FORMAT PURCH_TOT_DOL3
FORMAT PURCH_TOT_DOL4
FORMAT ALL_PURCH_DOL
LABEL_13
TRAP KEY_0x6C GOSUB LABEL_9
TRAP f1 GOSUB LABEL_10
SAVES
WINDOW 5, 11, 13, 70, FIELD[37], ' Purch for this Vendor ', 'l', 'd', 'r'
MOUNT SCREEN
LABEL_29 '', 'ESC Exit'
TRAP ESC GOTO LABEL_119
GOSUB LABEL_121
UPAR LABEL_0
ENTER FROM_DATE1
ENTER THRU_DATE1, THRU_DATE1>=FROM_DATE1, PRE=FROM_DATE1<>0, DFLT=FROM_DATE1, VMSG='Thru must be >= From'
ENTER FROM_DATE2, PRE=THRU_DATE1<>0
ENTER THRU_DATE2, THRU_DATE2>=FROM_DATE2, PRE=FROM_DATE2<>0, DFLT=FROM_DATE2, VMSG='Thru must be >= From'
ENTER FROM_DATE3, PRE=THRU_DATE2<>0
LABEL_40:
ENTER THRU_DATE3, THRU_DATE3>=FROM_DATE3, PRE=FROM_DATE3<>0, DFLT=FROM_DATE3, VMSG='Thru must be >= From'
ENTER FROM_DATE4, PRE=THRU_DATE3<>0
ENTER THRU_DATE4, THRU_DATE4>=FROM_DATE4, PRE=FROM_DATE4<>0, DFLT=FROM_DATE4, VMSG='Thru must be >= From'
SCAN BKAPHPO_HNDL, 3, BKAP.VENDCODE
   IF FROM_DATE1<>0
      IF (BKAP.PO.ORDDTE>=FROM_DATE1) .AND. BKAP.PO.ORDDTE<=THRU_DATE1
         PURCH_QTY1 = PURCH_QTY1+1
LABEL_41:
         PURCH_TOT_DOL1 = PURCH_TOT_DOL1+BKAP.PO.SUBTOT
      ENDIF
   ENDIF
   IF FROM_DATE2<>0
      IF (BKAP.PO.ORDDTE>=FROM_DATE2) .AND. BKAP.PO.ORDDTE<=THRU_DATE2
         PURCH_QTY2 = PURCH_QTY2+1
         PURCH_TOT_DOL2 = PURCH_TOT_DOL2+BKAP.PO.SUBTOT
      ENDIF
   ENDIF
   IF FROM_DATE3<>0
      IF (BKAP.PO.ORDDTE>=FROM_DATE3) .AND. BKAP.PO.ORDDTE<=THRU_DATE3
         PURCH_QTY3 = PURCH_QTY3+1
         PURCH_TOT_DOL3 = PURCH_TOT_DOL3+BKAP.PO.SUBTOT
      ENDIF
   ENDIF
   IF FROM_DATE4<>0
      IF (BKAP.PO.ORDDTE>=FROM_DATE4) .AND. BKAP.PO.ORDDTE<=THRU_DATE4
         PURCH_QTY4 = PURCH_QTY4+1
         PURCH_TOT_DOL4 = PURCH_TOT_DOL4+BKAP.PO.SUBTOT
      ENDIF
   ENDIF
   ALL_PURCH_QTY = ALL_PURCH_QTY+1
   ALL_PURCH_DOL = ALL_PURCH_DOL+BKAP.PO.SUBTOT
ENDS
AVG_PURCH1 = PURCH_TOT_DOL1*PURCH_QTY1
AVG_PURCH2 = PURCH_TOT_DOL2*PURCH_QTY2
AVG_PURCH3 = PURCH_TOT_DOL3*PURCH_QTY3
AVG_PURCH4 = PURCH_TOT_DOL4*PURCH_QTY4
AVG_TOT_PURCH = ALL_PURCH_DOL*ALL_PURCH_QTY
ASK 'Do you wish to print-out this data? N'
IF ASK()
   SAVES
   PON
   PMSG ' Purchases for vendor: ', BKAP.VENDCODE, ' ', BKAP.VENDNAME
   PMSG ''
   IF FROM_DATE1<>0
      PMSG ' ', FROM_DATE1, '-', THRU_DATE1, '  Qty: ', PURCH_QTY1, '  Tot$: ', PURCH_TOT_DOL1, '  Avg: ', AVG_PURCH1
      PMSG ''
   ENDIF
   IF FROM_DATE2<>0
      PMSG ' ', FROM_DATE2, '-', THRU_DATE2, '  Qty: ', PURCH_QTY2, '  Tot$: ', PURCH_TOT_DOL2, '  Avg: ', AVG_PURCH2
      PMSG ''
   ENDIF
   IF FROM_DATE3<>0
      PMSG ' ', FROM_DATE3, '-', THRU_DATE3, '  Qty: ', PURCH_QTY3, '  Tot$: ', PURCH_TOT_DOL3, '  Avg: ', AVG_PURCH3
      PMSG ''
   ENDIF
   IF FROM_DATE4<>0
      PMSG ' ', FROM_DATE4, '-', THRU_DATE4, '  Qty: ', PURCH_QTY4, '  Tot$: ', PURCH_TOT_DOL4, '  Avg: ', AVG_PURCH4
      PMSG ''
   ENDIF
   PMSG '   All Purchases    Qty: ', ALL_PURCH_QTY, '  Tot$: ', ALL_PURCH_DOL, '  Avg: ', AVG_TOT_PURCH
      IF .NOT. WINDOWS() THEN
   PTOF
      IF PWHR()='P' THEN
   EXEC 'BKTOF'
   PSET
   REDSP
ENDIF
GOTO LABEL_120
PURCH_QTY1 = 0
PURCH_TOT_DOL1 = 0
AVG_PURCH1 = 0
PURCH_QTY2 = 0
PURCH_TOT_DOL2 = 0
AVG_PURCH2 = 0
PURCH_QTY3 = 0
PURCH_TOT_DOL3 = 0
AVG_PURCH3 = 0
PURCH_QTY4 = 0
PURCH_TOT_DOL4 = 0
LABEL_42:
AVG_PURCH4 = 0
ALL_PURCH_QTY = 0
ALL_PURCH_DOL = 0
AVG_TOT_PURCH = 0
RET
OPENV 'bkapaprc.dat', N, BKAPAPRC_HNDL, 32, FROM_DATE1
WRITE BKAPAPRC_HNDL, 32
CLOSE BKAPAPRC_HNDL
REDSP
LABEL_14
RET
NAME_HLDR = JUST(BKAP.VENDNAME,'c')
MONTHS = 'JanFebMarAprMayJunJlyAugSepOctNovDec'
SAVES
PUSHT
TRAP ESC,INT GOTO LABEL_122
MSG 'Please wait...Loading purch info', NOWAIT
UPDTA GROSS_PRCH_AMT, CLR
LABEL_44:
FOUND_PRCH = .F.
SCAN BKAPHPO_HNDL, 3, BKAP.VENDCODE
   FIELD[36] = VAL(YEAR(DATE()))-VAL(YEAR(BKAP.PO.ORDDTE))+1
   FIELD[35] = LABEL_5(FIELD[36],MNTH(BKAP.PO.ORDDTE),12)
   GROSS_PRCH_AMT[FIELD[35]] = GROSS_PRCH_AMT[FIELD[35]]+BKAP.PO.SUBTOT
   YEAR_ARRAY[FIELD[36]] = YEAR(BKAP.PO.ORDDTE)
   FOUND_PRCH = .T.
ENDS
REDSP
LABEL_45:
SAVES
IF .NOT. FOUND_PRCH
   MSG 'There are no purchases in the history file for this vendor.', NOWAIT
   GOTO LABEL_122
ENDIF
GOSUB LABEL_123
MOUNT REPORT, L
   IF PRINT_CANCEL() GOTO LABEL_124
LABEL_42 'n'
TRAP PERR GOSUB LABEL_125
PAGE_NUM = 1
   IF .NOT. LABEL_126() GOTO LABEL_122
GROSS_TOTALS = 0
FIELD[35] = 1
LABEL_46:
ENDW
FOR FIELD[35] = ; 5
   YEAR_SHORT = YEAR_ARRAY[FIELD[35]]
   YEAR_LONG = 'Year: '+YEAR_SHORT
   GROSS_MTD_SUBT = 0
   FIELD[36] = 1
ENDW
FOR FIELD[36] = ; 12
   IF GROSS_PRCH_AMT[LABEL_5(FIELD[35],FIELD[36],12)]<>0
      MONTH = MID(MONTHS,FIELD[36]-1+3+1,3)
      PURCH.MTD = GROSS_PRCH_AMT[LABEL_5(FIELD[35],FIELD[36],12)]
         IF .NOT. LABEL_127() GOTO LABEL_122
LABEL_47:
      GROSS_MTD_SUBT = GROSS_MTD_SUBT+PURCH.MTD
      YEAR_LONG = ''
   ENDIF
ENDW
NEXT
IF GROSS_MTD_SUBT<>0
      IF .NOT. LABEL_128() GOTO LABEL_122
   GROSS_TOTALS = GROSS_TOTALS+GROSS_MTD_SUBT
ENDIF
LABEL_48:
ENDW
NEXT
   IF .NOT. LABEL_129() GOTO LABEL_122
LABEL_42 'f'
POPT
REDSP
RET
DATE_TIME_FLD = MDY(DATE())+' '+TTOC(TIME(),7)
LABEL_49:
DATE_TIME_FLD = JUST(DATE_TIME_FLD,'c')
RET
FUNC LABEL_126
PFMT 1
PFMT 2
PFMT 3
PFMT 4
PFMT 5
PFMT 6
PFMT 7
UPDTA BKAPAP2_HLL, CLR
GETLBL LABEL_126, BKAPAP2_HLL[1]
INC PAGE_NUM
RET
FUNC LABEL_127
PFMT 8
LABEL_50:
RET
FUNC LABEL_128
PFMT 9
PFMT 10
PFMT 11
LABEL_51:
RET
FUNC LABEL_129
PFMT 12
PFMT 13
RET
FUNC LABEL_125
BKAPAP2_PHCNTR = 1
ENDW
FOR BKAPAP2_PHCNTR = ; 20
   IF BKAPAP2_HLL[BKAPAP2_PHCNTR]<>0
      GOSUBL
      BKAPAP2_PHRET = RETVAL()
         IF .NOT. BKAPAP2_PHRET THEN
      RET
   ENDIF
ENDW
NEXT
RET
SAVES
LABEL_13
IF WINDOWS()
   WINDOW 2, 15, 10, 78, FIELD[37], ' Current P/O's for this Vendor ', 'L', 'S', 'R'
ELSE
LABEL_52:
   WINDOW 1, 15, 10, 80, FIELD[37], ' Current P/O's for this Vendor ', 'L', 'S', 'R'
ENDIF
IF IN_BKPOA
   LABEL_29 '', 'ESC Exit'
ELSE
   LABEL_29 'Move cursor/press ENTER to View/Change,INSERT Add New', 'ESC Exit'
ENDIF
SETLINE BKAPAPO_TTL1, 'P/O Num', 'Ord Date', 'Ord Desc                      ', 'Ord Total   ', 'Ship To Code', 'Ship To Name                  ', 'Ship To Add1                  ', 'Ship To Add2                  ', 'Ship To City   ', 'Ship To St', 'Ship To Zip', 'Terms     ', 'Ent By', 'Ordered For', 'Tax?', 'Tax Rate', 'Subtot      ', 'Tax Amt     ', 'Amt Recv Not Yet Inv', 'Printed?'
SETLINE BKAPAPO_USCORE, 'ÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄ', 'ÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄ'
LISTF STR(BKAP.PO.NUM)+FILL(1,' '), BKAP.PO.ORDDTE, BKAP.PO.DESC, BKAP.PO.TOTAL, BKAP.PO.SHPCOD+FILL(2,' '), BKAP.PO.SHPNME, BKAP.PO.SHPA1, BKAP.PO.SHPA2, BKAP.PO.SHPCTY, BKAP.PO.SHPST+FILL(8,' '), BKAP.PO.SHPZIP+FILL(1,' '), BKAP.PO.TERMD, BKAP.PO.ENTBY+' ', BKAP.PO.OBYCUS+FILL(1,' '), BKAP.PO.TAXABLE+FILL(3,' '), STR(BKAP.PO.TAXRTE)+FILL(3,' '), BKAP.PO.SUBTOT, STR(BKAP.PO.TAXAMT)+FILL(4,' '), STR(BKAP.PO.RNI.D)+FILL(8,' '), BKAP.PO.PRTD+FILL(7,' '), BKAPPO_HNDL, 5, BKAP.PO.VNDCOD=BKAP.VENDCODE, BKAP.VENDCODE
LABEL_14
LABEL_53:
REDSP
SCRN
RET
SAVES
LABEL_13
IF WINDOWS()
   WINDOW 2, 15, 10, 78, FIELD[37], ' Received P/O's for this Vendor ', 'L', 'S', 'R'
ELSE
LABEL_54:
   WINDOW 1, 15, 10, 80, FIELD[37], ' Received P/O's for this Vendor ', 'L', 'S', 'R'
ENDIF
LABEL_29 'Move cursor/press ENTER to View', 'ESC Exit'
SETLINE BKAPAHPO_TTL1, 'P/O Num', 'Ord Date', 'Ord Desc                      ', 'Ship To Code', 'Ship To Name                  ', 'Ship To Add1                  ', 'Ship To Add2                  ', 'Ship To City   ', 'Ship To St', 'Ship To Zip', 'Terms     ', 'Ent By', 'Ordered For', 'Tax?', 'Tax Rate', 'Subtot      ', 'Tax Amt     ', 'Ord Total   ', 'Amt Recv Not Yet Inv', 'Printed?'
SETLINE BKAPAHPO_USCORE, 'ÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄ', 'ÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄ'
LISTF STR(BKAP.PO.NUM)+FILL(1,' '), BKAP.PO.ORDDTE, BKAP.PO.DESC, BKAP.PO.SHPCOD+FILL(2,' '), BKAP.PO.SHPNME, BKAP.PO.SHPA1, BKAP.PO.SHPA2, BKAP.PO.SHPCTY, BKAP.PO.SHPST+FILL(8,' '), BKAP.PO.SHPZIP+FILL(1,' '), BKAP.PO.TERMD, BKAP.PO.ENTBY+FILL(1,' '), BKAP.PO.OBYCUS+FILL(1,' '), BKAP.PO.TAXABLE+FILL(3,' '), STR(BKAP.PO.TAXRTE)+FILL(3,' '), BKAP.PO.SUBTOT, STR(BKAP.PO.TAXAMT)+FILL(4,' '), BKAP.PO.TOTAL, STR(BKAP.PO.RNI.D)+FILL(8,' '), BKAP.PO.PRTD+FILL(7,' '), BKAPHPO_HNDL, 5, BKAP.PO.VNDCOD=BKAP.VENDCODE, BKAP.VENDCODE
LABEL_14
REDSP
RET
SAVES
LABEL_13
IF WINDOWS()
   WINDOW 2, 15, 10, 78, FIELD[37], ' Enter/Change/Delete Addresses ', 'L', 'D', 'r'
ELSE
   WINDOW 1, 15, 10, 80, FIELD[37], ' Enter/Change/Delete Addresses ', 'L', 'D'
ENDIF
LABEL_29 'Move cursor/press ENTER to Change,INSERT Add New,DELETE', 'ESC Exit'
LABEL_55:
SETLINE BKAPADDR_TTL1, 'Name                          ', 'Address Line 1                ', 'Address Line 2                ', 'City           ', 'State', 'Zip Code  ', 'Country                       ', 'Use for comment          '
SETLINE BKAPADDR_USCORE, 'ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ'
LISTF BKAP.ADDR.NAME, BKAP.ADDR.ADD1, BKAP.ADDR.ADD2, BKAP.ADDR.CITY, BKAP.ADDR.STATE+FILL(3,' '), BKAP.ADDR.ZIP, BKAP.COUNTRY, BKAP.ADDR.COM, BKAPADDR_HNDL, 1, BKAP.ADDR.CODE=BKAP.VENDCODE, BKAP.VENDCODE
LABEL_14
REDSP
CLR BKAPADDR_HNDL
RET
FUNC LABEL_130
IF ETYP()='D'
   ASK ' Are you sure you want to delete this address? Y'
   RET
ENDIF
LABEL_13
TRAP ESC GOTO LABEL_131
TRAP f10 GOTO LABEL_132
SAVES
WINDOW 36, 12, 12, 45, LABEL_19(), ' Enter/Modify this Address ', 'l', 'D', IIF(WINDOWS(),'r','n')
LABEL_29 'F10 Save', 'ESC Return to List'
MOUNT SCREEN
UPAR LABEL_0
ENTER BKAP.ADDR.NAME, DFLT=IIF(IFNA(BKAPADDR_HNDL),BKAP.VENDNAME,'')
ENTER BKAP.ADDR.ADD1, DFLT=IIF(IFNA(BKAPADDR_HNDL),BKAP.ADD1,'')
ENTER BKAP.ADDR.ADD2, DFLT=IIF(IFNA(BKAPADDR_HNDL),BKAP.ADD2,'')
LABEL_56:
ENTER BKAP.ADDR.CITY, DFLT=IIF(IFNA(BKAPADDR_HNDL),BKAP.CITY,'')
ENTER BKAP.ADDR.STATE, DFLT=IIF(IFNA(BKAPADDR_HNDL),BKAP.STATE,'')
ENTER BKAP.ADDR.ZIP, DFLT=IIF(IFNA(BKAPADDR_HNDL),BKAP.ZIP,'')
ENTER BKAP.ADDR.CNTRY, DFLT=IIF(IFNA(BKAPADDR_HNDL),BKAP.COUNTRY,'')
ENTER BKAP.ADDR.COM
BKAP.ADDR.CODE = BKAP.VENDCODE
LABEL_14
REDSP
IF BKAP.ADDR.NAME=''
LABEL_57:
   FIELD[86][1] = 'You must enter at least a name to create a new alternate address rec'
   LABEL_17 FIELD[87], 1
   RET
ENDIF
RET
IF REC_CHANGED(BKAPADDR_HNDL)
   IF LABEL_50('Vendor Address File')
      BKAP.ADDR.CODE = BKAP.VENDCODE
      LABEL_14
      REDSP
      RET
   ENDIF
ENDIF
LABEL_14
REDSP
RET
SAVES
LABEL_13
IF WINDOWS()
   WINDOW 2, 15, 10, 78, FIELD[37], ' Enter/Change/Delete Contacts ', 'L', 'D', 'r'
ELSE
   WINDOW 1, 15, 10, 80, FIELD[37], ' Enter/Change/Delete Contacts ', 'L', 'D'
ENDIF
LABEL_29 'Move cursor/press ENTER to Change,INSERT Add New,DELETE', 'ESC Exit'
SETLINE VENDCONT_TTL1, 'Name                     ', 'Contact Location/Title   ', 'Telephone Num            ', 'Fax Phone Num            '
SETLINE VENDCONT_USCORE, 'ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ'
LISTF BKAP.CONT.NAME, BKAP.CONT.LOC, BKAP.CONT.PHONE, BKAP.CONT.FAX, BKAPCONT_HNDL, 1, BKAP.CONT.CODE=BKAP.VENDCODE, BKAP.VENDCODE
LABEL_14
REDSP
CLR BKAPCONT_HNDL
RET
FUNC LABEL_133
IF ETYP()='D'
   ASK ' Are you sure you want to delete this contact? Y'
   RET
ENDIF
LABEL_13
TRAP ESC GOTO LABEL_134
TRAP f10 GOTO LABEL_135
SAVES
WINDOW 35, 13, 8, 46, LABEL_19(), ' Enter/Modify this Contact ', 'l', 'D', IIF(WINDOWS(),'r','n')
LABEL_29 'F10 Save', 'ESC Return to List'
MOUNT SCREEN
UPAR LABEL_0
LABEL_58:
ENTER BKAP.CONT.NAME
ENTER BKAP.CONT.PHONE
ENTER BKAP.CONT.FAX
ENTER BKAP.CONT.LOC
BKAP.CONT.CODE = BKAP.VENDCODE
LABEL_14
REDSP
IF BKAP.CONT.NAME=''
   FIELD[86][1] = 'You must enter at least a name to create a new alternate contact rec'
   LABEL_17 FIELD[87], 1
LABEL_59:
   RET
ENDIF
RET
IF REC_CHANGED(BKAPCONT_HNDL)
   IF LABEL_50('Vendor Contact File')
      BKAP.CONT.CODE = BKAP.VENDCODE
      LABEL_14
      REDSP
      RET
   ENDIF
ENDIF
LABEL_14
REDSP
LABEL_0:
RET
IF BKAP.VENDCODE='' .OR. BKAP.VENDNAME='' .OR. BKAP.ADD1=''
   FIELD[279] = .T.
ENDIF
RET
IF BKAP.ADDR.NAME='' .OR. BKAP.ADDR.ADD1=''
   FIELD[279] = .T.
ENDIF
RET
   IF BKAP.CONT.NAME='' THEN
FIELD[279] = .T.
RET
RET
LABEL_136
OPENV HPOFILE, N, BKAPHPO_HNDL
OPENV HPOLFILE, N, BKAPHPOL_HNDL
RET
CLOSE BKAPHPO_HNDL
CLOSE BKAPHPOL_HNDL
RET
SAVES
LABEL_13
IF WINDOWS()
   WINDOW 2, 15, 10, 78, ' A/P Vouchers ', 'L', 'S', 'R'
ELSE
   WINDOW 1, 15, 10, 80, FIELD[37], ' A/P Vouchers ', 'L', 'S', 'R'
ENDIF
LABEL_29 'Move cursor to view', 'ESC Exit'
SETLINE APVOUCH_TTL1, 'Inv Date', 'Due Date', 'Inv Num   ', 'Description              ', 'Type      ', 'Total Amount '
SETLINE APVOUCH_USCORE, 'ÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄÄÄ'
LISTF DTOC(BKAP.INVL.DATE), DTOC(BKAP.INVL.DUEDT), BKAP.INVL.NUM, BKAP.INVL.DESC, BKAP.INVL.TYPED, BKAP.INVL.TAMT, BKAPINVL_HNDL, 2, BKAP.INVL.CODE=BKAP.VENDCODE, BKAP.VENDCODE
LABEL_14
REDSP
SCRN
RET
SAVES
LABEL_13
LABEL_66:
IF WINDOWS()
   WINDOW 2, 15, 10, 78, ' A/P Payment History ', 'L', 'S', 'R'
ELSE
   WINDOW 1, 15, 10, 80, FIELD[37], ' A/P Payment History ', 'L', 'S', 'R'
ENDIF
LABEL_29 'Move cursor to view', 'ESC Exit'
SETLINE CHKH_TTL1, 'Chk Date', 'Inv Date', 'Inv Num   ', 'Description              ', 'Chk Num', 'Acct', 'Invoice Amt ', 'Amount Paid '
SETLINE CHKH_USCORE, 'ÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄ', 'ÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄÄ'
LISTF DTOC(BKAP.CHK.CHKDTE), DTOC(BKAP.CHK.INVDTE), BKAP.CHK.INVNUM, BKAP.CHK.DESC, STR(BKAP.CHK.NUM)+FILL(1,' '), STR(BKAP.CHK.CHKACT)+FILL(2,' '), BKAP.CHK.INVAMT, BKAP.CHK.AMTPD, BKAPCHKH_HNDL, 5, BKAP.CHK.VNDCOD=BKAP.VENDCODE, BKAP.VENDCODE
LABEL_14
REDSP
SCRN
RET
RET
SAVES
LABEL_13
IF WINDOWS()
   WINDOW 2, 15, 10, 78, ' Recurring Vouchers for this Vendor ', 'L', 'S', 'R'
ELSE
   WINDOW 1, 15, 10, 80, FIELD[37], ' Recurring Vouchers for this Vendor ', 'L', 'S', 'R'
ENDIF
LABEL_29 'Move cursor to view', 'ESC Exit'
SETLINE RRAP_TTL1, 'Num       ', 'Description              ', 'Type      ', 'Freq', 'Max', 'Next Date', 'Total Amount '
SETLINE RRAP_USCORE, 'ÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄ', 'ÄÄÄ', 'ÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄÄÄ'
LISTF BKAP.INVL.NUM, BKAP.INVL.DESC, BKAP.INVL.TYPED, STR(MID(BKAP.INVL.TERMD,2,2))+FILL(2,' '), STR(MID(BKAP.INVL.TERMD,4,2))+FILL(1,' '), DTOC(BKAP.INVL.DATE)+FILL(1,' '), BKAP.INVL.TAMT, BKAPRIVL_HNDL, 2, BKAP.INVL.CODE=BKAP.VENDCODE, BKAP.VENDCODE
LABEL_14
REDSP
SCRN
RET
QUIT
FUNC LABEL_96(LIST_VEND_KEY, LIST_VEND_HNDL)
LABEL_68:
FIELD[117] = LIST_VEND_KEY
IF TRC(LIST_VEND_HNDL)=0
   MSG 'There are no Vendors to list', NOWAIT
   RET
ENDIF
SAVES
LABEL_13
IF WINDOWS()
   WINDOW 2, IIF(FIELD[54]='Y',2,15), IIF(FIELD[54]='Y',23,10), 78, FIELD[37], ' Vendors ', 'L', 'S', 'r'
ELSE
   WINDOW 1, IIF(FIELD[54]='Y',2,15), IIF(FIELD[54]='Y',23,10), 80, FIELD[37], ' Vendors ', 'L', 'S'
ENDIF
IF FIELD[54]='Y'
   LABEL_29 'F1 Help,F3 Choose other key,F4 List partial screen', 'ESC Exit'
ELSE
   LABEL_29 'F1 Help,F3 Choose other key,F4 List full screen', 'ESC Exit'
ENDIF
TRAP f3 GOTO LABEL_138
TRAP f4 GOTO LABEL_139
TRAP RLCK GOTO LABEL_140
SELECT FIELD[117]
CASE 1
LABEL_70:
   SETLINE VENDNORM_TTL1, 'Code      ', 'Name                          ', 'Active?', 'Your Acct#               ', 'State', 'Zip Code  ', 'Contact                  ', 'Telephone #              '
   SETLINE VENDNORM_USCORE, 'ÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ'
   LISTF BKAP.VENDCODE, BKAP.VENDNAME, FILL(3,' ')+BKAP.ACTIVE+FILL(3,' '), BKAP.YOUR.ACCT, BKAP.STATE+FILL(3,' '), BKAP.ZIP, BKAP.CONTACT, BKAP.TELEPHONE, BKAPVEND_HNDL, FIELD[117]
CASE 4
   SETLINE VENDNORM_TTL1, 'Name                          ', 'Code      ', 'Active?', 'Your Acct#               ', 'State', 'Zip Code  ', 'Contact                  ', 'Telephone #              '
   SETLINE VENDNORM_USCORE, 'ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ'
   LISTF BKAP.VENDNAME, BKAP.VENDCODE, FILL(3,' ')+BKAP.ACTIVE+FILL(3,' '), BKAP.YOUR.ACCT, BKAP.STATE+FILL(3,' '), BKAP.ZIP, BKAP.CONTACT, BKAP.TELEPHONE, BKAPVEND_HNDL, FIELD[117]
CASE 5
   SETLINE VENDNORM_TTL1, 'Your Acct#               ', 'Code      ', 'Name                          ', 'Active?', 'State', 'Zip Code  ', 'Contact                  ', 'Telephone #              '
   SETLINE VENDNORM_USCORE, 'ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄ', 'ÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ'
   LISTF BKAP.YOUR.ACCT, BKAP.VENDCODE, BKAP.VENDNAME, FILL(3,' ')+BKAP.ACTIVE+FILL(3,' '), BKAP.STATE+FILL(3,' '), BKAP.ZIP, BKAP.CONTACT, BKAP.TELEPHONE, BKAPVEND_HNDL, FIELD[117]
CASE 2
   SETLINE VENDNORM_TTL1, 'State', 'Code      ', 'Name                          ', 'Active?', 'Your Acct#               ', 'Zip Code  ', 'Contact                  ', 'Telephone #              '
   SETLINE VENDNORM_USCORE, 'ÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ'
LABEL_74:
   LISTF BKAP.STATE+FILL(3,' '), BKAP.VENDCODE, BKAP.VENDNAME, FILL(3,' ')+BKAP.ACTIVE+FILL(3,' '), BKAP.YOUR.ACCT, BKAP.ZIP, BKAP.CONTACT, BKAP.TELEPHONE, BKAPVEND_HNDL, FIELD[117]
CASE 3
   SETLINE VENDNORM_TTL1, 'Zip Code  ', 'Code      ', 'Name                          ', 'Active?', 'Your Acct#               ', 'State', 'Contact                  ', 'Telephone #              '
   SETLINE VENDNORM_USCORE, 'ÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ'
   LISTF BKAP.ZIP, BKAP.VENDCODE, BKAP.VENDNAME, FILL(3,' ')+BKAP.ACTIVE+FILL(3,' '), BKAP.YOUR.ACCT, BKAP.STATE+FILL(3,' '), BKAP.CONTACT, BKAP.TELEPHONE, BKAPVEND_HNDL, FIELD[117]
ENDC
LABEL_14
REDSP
LABEL_76:
RET
CHAIN FIELD[81]+'bkschkys'
CLR LIST_VEND_HNDL
   IF FIELD[117]=255 THEN
FIELD[117] = 1
GOTO LABEL_141
LABEL_14
REDSP
IF FIELD[54]='Y'
   FIELD[54] = 'N'
ELSE
   FIELD[54] = 'Y'
ENDIF
GOTO LABEL_137
IF LSTCHR()=317
   CLR BKAPVEND_HNDL
   CHAIN FIELD[81]+'bkschkys'
      IF FIELD[117]=255 THEN
   FIELD[117] = 1
   LABEL_14
   REDSP
   GOTO LABEL_141
ENDIF
IF LSTCHR()=318
   CLR BKAPVEND_HNDL
   GOTO LABEL_139
ENDIF
LABEL_14
REDSP
MSG 'The record for this vendor is currently locked.', NOWAIT
CLR BKAPVEND_HNDL
TRAP RLCK DFLT
LABEL_79:
RET
FUNC LABEL_100(LIST_GLCOA_KEY, LIST_GLCOA_HNDL, LIST_GLCOA_TYPE)
FIELD[117] = LIST_GLCOA_KEY
IF TRC(LIST_GLCOA_HNDL)=0
LABEL_80:
   MSG 'There are no G/L Accounts to list', NOWAIT
   RET
ENDIF
SAVES
LABEL_13
IF WINDOWS()
   WINDOW 2, IIF(FIELD[54]='Y',2,15), IIF(FIELD[54]='Y',23,10), 78, FIELD[37], ' G/L Account Codes & Names ', 'L', 'S', 'r'
ELSE
LABEL_81:
   WINDOW 1, IIF(FIELD[54]='Y',2,15), IIF(FIELD[54]='Y',23,10), 80, FIELD[37], ' G/L Account Codes & Names ', 'L', 'S'
ENDIF
IF FIELD[54]='Y'
   LABEL_29 'F1 Help,F3 Choose other key,F4 List partial screen', 'ESC Exit'
ELSE
   LABEL_29 'F1 Help,F3 Choose other key,F4 List full screen', 'ESC Exit'
ENDIF
TRAP f3 GOTO LABEL_143
TRAP f4 GOTO LABEL_144
TRAP f1 GOSUB LABEL_145
SELECT FIELD[117]
CASE 1
   SETLINE GLCAF2_TTL1, 'Acct Number', 'Department', 'Acct Type', 'Acct Description         ', 'Active?'
   SETLINE GLCAF2_USCORE, 'ÄÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄ'
   LISTF FIELD[152]+FILL(1,' '), FIELD[153]+FILL(6,' '), BKGL.TYPE+FILL(8,' '), BKGL.ACCTD, FILL(3,' ')+BKGL.ACTIVE+FILL(3,' '), LIST_GLCOA_HNDL, 1, IIF(LIST_GLCOA_TYPE<>'',BKGL.TYPE=LIST_GLCOA_TYPE,.T.)
CASE 2
   SETLINE GLCAF2_TTL1, 'Acct Number', 'Department', 'Acct Type', 'Acct Description         ', 'Active?'
   SETLINE GLCAF2_USCORE, 'ÄÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄ'
   LISTF FIELD[152]+FILL(1,' '), FIELD[153]+FILL(6,' '), BKGL.TYPE+FILL(8,' '), BKGL.ACCTD, FILL(3,' ')+BKGL.ACTIVE+FILL(3,' '), LIST_GLCOA_HNDL, 2, IIF(LIST_GLCOA_TYPE<>'',BKGL.TYPE=LIST_GLCOA_TYPE,.T.)
CASE 3
   SETLINE GLCAF2_TTL1, 'Acct Description         ', 'Acct Number', 'Department', 'Acct Type', 'Active?'
   SETLINE GLCAF2_USCORE, 'ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄ'
   LISTF BKGL.ACCTD, FIELD[152]+FILL(1,' '), FIELD[153]+FILL(6,' '), BKGL.TYPE+FILL(8,' '), FILL(3,' ')+BKGL.ACTIVE+FILL(3,' '), LIST_GLCOA_HNDL, 3, IIF(LIST_GLCOA_TYPE<>'',BKGL.TYPE=LIST_GLCOA_TYPE,.T.)
   FIELD[86][1] = ' This key is not available in this lookup list. '
   LABEL_17 FIELD[87], 1
   FIELD[117] = 1
   GOTO LABEL_146
ENDC
LABEL_14
REDSP
LABEL_82:
RET
LABEL_13
CHAIN FIELD[81]+'bkschkys'
LABEL_14
CLR LIST_GLCOA_HNDL
   IF FIELD[117]=255 THEN
FIELD[117] = 1
GOTO LABEL_146
LABEL_14
REDSP
IF FIELD[54]='Y'
   FIELD[54] = 'N'
ELSE
   FIELD[54] = 'Y'
ENDIF
GOTO LABEL_142
RET
FUNC LABEL_61
IF LOGON_CODE=''
   XFER 1, LOGON_CODE, 15, 2
ENDIF
IF LOGON_CODE=''
   MSG 'You may not run this program without a logon code.', NOWAIT
   RET
ENDIF
XFER LOGON_CODE, 1, 15, 2
RET
FUNC LABEL_62
OPENV 'BKSYMSTS', N, BKSYMSTS_HNDL
FINDV F, BKSYMSTS_HNDL, 44761343, LABEL_0
IF FLERR()<>0
   MSG 'The supplemental system file has not been set-up.  Select option E under System Maintenance option A.', NOWAIT
   RET
ENDIF
RET
FUNC LABEL_88(LIST_TERM_KEY, LIST_TERM_HNDL, LIST_TERM_FROM)
FIELD[117] = LIST_TERM_KEY
IF TRC(LIST_TERM_HNDL)=0
   MSG 'There are no terms to list', NOWAIT
   RET
ENDIF
GOSUB LABEL_147
RET
FUNC LABEL_99
IF BKGL.ACTIVE='N'
LABEL_83:
   MSG 'This is not an active G/L account.', NOWAIT
   NOVLDMSG
   RET
ENDIF
RET
SAVES
LABEL_13
LABEL_84:
IF WINDOWS()
   WINDOW 2, IIF(FIELD[54]='Y',2,15), IIF(FIELD[54]='Y',23,10), 78, FIELD[37], ' Terms ', 'L', 'S', 'r'
ELSE
   WINDOW 1, IIF(FIELD[54]='Y',2,15), IIF(FIELD[54]='Y',23,10), 80, FIELD[37], ' Terms ', 'L', 'S'
ENDIF
IF FIELD[54]='Y'
   LABEL_29 'F1 Help,F3 Choose other key,F4 List partial screen', 'ESC Exit'
LABEL_86:
ELSE
   LABEL_29 'F1 Help,F3 Choose other key,F4 List full screen', 'ESC Exit'
ENDIF
TRAP f3 GOTO LABEL_148
TRAP f4 GOTO LABEL_149
SELECT FIELD[117]
LABEL_85:
CASE 1
   SETLINE TERMNORM_TTL1, 'Num', 'Terms     ', 'Discount', 'Type', 'Days', 'Max', 'Use', 'Calc'
   SETLINE TERMNORM_USCORE, 'ÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄ', 'ÄÄÄÄ', 'ÄÄÄÄ', 'ÄÄÄ', 'ÄÄÄ', 'ÄÄÄÄ'
   IF LIST_TERM_FROM='R'
      LISTF BKSY.TERM.NUM, BKSY.TERM.DESC, FILL(3,' ')+STR(BKSY.TERM.DAMT), BKSY.TERM.TYP+FILL(3,' '), FILL(1,' ')+BKSY.TERM.DAYS, BKSY.TERM.MAX, FILL(1,' ')+BKSY.TERM.USE+FILL(1,' '), BKSY.TERM.CALC+FILL(3,' '), LIST_TERM_HNDL, FIELD[117], BKSY.TERM.USE<>'P'
   ENDIF
   LISTF BKSY.TERM.NUM, BKSY.TERM.DESC, FILL(3,' ')+STR(BKSY.TERM.DAMT), BKSY.TERM.TYP+FILL(3,' '), FILL(1,' ')+BKSY.TERM.DAYS, BKSY.TERM.MAX, FILL(1,' ')+BKSY.TERM.USE+FILL(1,' '), BKSY.TERM.CALC+FILL(3,' '), LIST_TERM_HNDL, FIELD[117], BKSY.TERM.USE<>'R'
ENDC
ELSE
CASE 2
LABEL_75:
   SETLINE TERMNORM_TTL1, 'Terms     ', 'Num', 'Discount', 'Type', 'Days', 'Max', 'Use', 'Calc'
   SETLINE TERMNORM_USCORE, 'ÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄ', 'ÄÄÄÄÄÄÄÄ', 'ÄÄÄÄ', 'ÄÄÄÄ', 'ÄÄÄ', 'ÄÄÄ', 'ÄÄÄÄ'
   IF LIST_TERM_FROM='R'
      LISTF BKSY.TERM.DESC, BKSY.TERM.NUM, FILL(3,' ')+STR(BKSY.TERM.DAMT), BKSY.TERM.TYP+FILL(3,' '), FILL(1,' ')+BKSY.TERM.DAYS, BKSY.TERM.MAX, FILL(1,' ')+BKSY.TERM.USE+FILL(1,' '), BKSY.TERM.CALC+FILL(3,' '), LIST_TERM_HNDL, FIELD[117], BKSY.TERM.USE<>'P'
   ELSE
      LISTF BKSY.TERM.DESC, BKSY.TERM.NUM, FILL(3,' ')+STR(BKSY.TERM.DAMT), BKSY.TERM.TYP+FILL(3,' '), FILL(1,' ')+BKSY.TERM.DAYS, BKSY.TERM.MAX, FILL(1,' ')+BKSY.TERM.USE+FILL(1,' '), BKSY.TERM.CALC+FILL(3,' '), LIST_TERM_HNDL, FIELD[117], BKSY.TERM.USE<>'R'
   ENDIF
ELSE
CASE 3
   SETLINE TERMNORM_TTL1, 'Use', 'Num', 'Terms     ', 'Discount', 'Type', 'Days', 'Max', 'Calc'
   SETLINE TERMNORM_USCORE, 'ÄÄÄ', 'ÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄ', 'ÄÄÄÄ', 'ÄÄÄÄ', 'ÄÄÄ', 'ÄÄÄÄ'
   IF LIST_TERM_FROM='R'
      LISTF FILL(1,' ')+BKSY.TERM.USE+FILL(1,' '), BKSY.TERM.NUM, BKSY.TERM.DESC, FILL(3,' ')+STR(BKSY.TERM.DAMT), BKSY.TERM.TYP+FILL(3,' '), FILL(1,' ')+BKSY.TERM.DAYS, BKSY.TERM.MAX, BKSY.TERM.CALC+FILL(3,' '), LIST_TERM_HNDL, FIELD[117], BKSY.TERM.USE<>'P'
   ELSE
      LISTF FILL(1,' ')+BKSY.TERM.USE+FILL(1,' '), BKSY.TERM.NUM, BKSY.TERM.DESC, FILL(3,' ')+STR(BKSY.TERM.DAMT), BKSY.TERM.TYP+FILL(3,' '), FILL(1,' ')+BKSY.TERM.DAYS, BKSY.TERM.MAX, BKSY.TERM.CALC+FILL(3,' '), LIST_TERM_HNDL, FIELD[117], BKSY.TERM.USE<>'R'
   ENDIF
ELSE
   FIELD[86][1] = ' This key is not available in this lookup list. '
   LABEL_17 FIELD[87], 1
   FIELD[117] = 1
   GOTO LABEL_150
   LABEL_14
   REDSP
   RET
   NMENU 'Number', 'Description', 'Use', 20, 15, 15, 'Select key', FIELD[117]
      IF FIELD[117]=0 THEN
   FIELD[117] = 1
   GOTO LABEL_150
   LABEL_14
   REDSP
   IF FIELD[54]='Y'
      FIELD[54] = 'N'
   ELSE
      FIELD[54] = 'Y'
   ENDIF
   GOTO LABEL_147
   CMD LABEL_136
   LABEL_13
   OPENV 'fileloc', 'B', N, FILELOC_HNDL
   FIELD[35] = 0
   SCAN FILELOC_HNDL, 1, 'BKAPPO', MID(LOC_FILE_NAME,7,2)='PO', LOC_BUFF_NAME='BKAPPO', 78
      INC FIELD[35]
   ENDS
   CLR FILELOC_HNDL
   IF FIELD[35]>0
      SAVES
      IF WINDOWS()
         WINDOW 2, IIF(FIELD[54]='Y',2,15), IIF(FIELD[54]='Y',23,10), 78, FIELD[37], ' Choose history files to open ', 'L', 'S', 'r'
      ELSE
         WINDOW 1, IIF(FIELD[54]='Y',2,15), IIF(FIELD[54]='Y',23,10), 80, FIELD[37], ' Choose history files to open ', 'L', 'S'
      ENDIF
      SETLINE LISTFILE_TTL1, 'File    ', 'Description                             '
      SETLINE LISTFILE_USCORE, 'ÄÄÄÄÄÄÄÄ', 'ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ'
      LISTF LOC_FILE_NAME, LOC_DESCRIPTION, FILELOC_HNDL, 1, MID(LOC_FILE_NAME,7,2)='PO' .OR. LOC_FILE_NAME='BKAPHPO', LOC_BUFF_NAME='BKAPPO', 'BKAPPO'
      REDSP
   ENDIF
LABEL_92:
   IF LOC_FILE_NAME='BKAPHPO' .OR. LOC_FILE_NAME=''
      HPOFILE = 'BKAPHPO'
      HPOLFILE = 'BKAPHPOL'
   ELSE
      HPOFILE = LOC_FILE_NAME
      HPOLFILE = 'BKAP'+MID(LOC_FILE_NAME,5,2)+'PL'
   ENDIF
   CLOSE FILELOC_HNDL
   LABEL_14
   RET

;End of Prg
\S5FORMAT1
  1Y  YSSREC_BKAPVEND SDREC_BKAPVEND SCREC_BKAPVEND NONE          NONE          YNN

ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ»
º Code:             Active?                Contact:                            º
º Name:                                      Phone:                            º
º Add1:                                        Fax:                            º
º Add2:                                  Your Acct:                            º
º  CSZ:                                   Prch YTD:                            º
º Ctry:                                        LYR:                            º
º                                                                              º
º Rmks:                                                                        º
º                                                                              º
º                                                                              º
º Class  Start     1099    Tax ID Number     Terms           Dflt G/L Acct     º
º                                                                      -       º
ºÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄº
º Crdts:              Inv:              Lst Prch:          Lst Pmt:            º
ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼
\COLOR
   1  1  1  2 80
   1  3  1  3 80
   1  4  1 25 80
\FIELDS
BKAP.VENDCODE    0  9  3  0  0 0   10    0    0AYRGBKAPVEND      10
BKAP.ACTIVE      0 29  3  0  0 0    1    0    0AYRGBKAPVENDNN     1
EXPR_FLD         0 34  3 17  0 0    0    0    0XNXGMEMORY         0        ==LABEL_47()
BKAP.CONTACT     0 53  3  0  0 0   25    0    0ANRGBKAPVENDNN    25
BKAP.VENDNAME    0  9  4  0  0 0   30    0    0ANRGBKAPVEND      30
BKAP.TELEPHONE   0 53  4  0  0 0   25    0    0AYRGBKAPVENDNN    25
BKAP.ADD1        0  9  5  0  0 0   30    0    0ANRGBKAPVENDNN    30
BKAP.FAX.PHONE   0 53  5  0  0 0   25    0    0AYRGBKAPVENDNN    25
BKAP.ADD2        0  9  6  0  0 0   30    0    0ANRGBKAPVENDNN    30
BKAP.YOUR.ACCT   0 53  6  0  0 0   25    0    0AYRGBKAPVEND      25
BKAP.CITY        0  9  7  0  0 0   15    0    0ANRGBKAPVENDNN    15
BKAP.STATE       0 25  7  0  0 0    2    0    0AYRGBKAPVEND       2
BKAP.ZIP         0 29  7  0  0 0   10    0    0AYRGBKAPVEND      10
BKAP.PURCH.YTD   0 53  7  0  0 2   12    0    0NNRGBKAPVENDNN    12
BKAP.COUNTRY     0  9  8  0  0 0   30    0    0AYRGBKAPVENDNN    30
BKAP.PURCH.LYR   0 53  8  0  0 2   12    0    0NNRGBKAPVENDNN    12
BKAP.COMMENTS1   0  9 10  0  0 0   69    0    0ANRGBKAPVENDNN    69
BKAP.COMMENTS2   0  9 11  0  0 0   69    0    0ANRGBKAPVENDNN    69
BKAP.CLASS       0  3 14  0  0 0    2    0    0AYRGBKAPVENDNN     2
BKAP.START.DATE  0 10 14  0  0 0    8    0    0DNRGBKAPVENDNN     8
BKAP.1099.TYPE   0 22 14  0  0 0    1    0    0AYRGBKAPVENDNN     1
BKAP.1099.ID     0 28 14  0  0 0   15    0    0AYRGBKAPVENDNN    15
BKAP.TERMS.NUM   0 47 14  0  0 0    3    0    0INRGBKAPVENDNN     3
BKAP.DFLT.GLACT  0 62 14  0  0 0   10    0    0AYRGBKAPVENDNN    10
BKAP.DFLT.GLDPT  0 73 14  0  0 0    4    0    0AYRGBKAPVENDNN     4
BKAP.OUT.CREDIT  0 10 16  0  0 2   12    0    0NNRGBKAPVENDNN    12
BKAP.OUTINV      0 28 16  0  0 2   12    0    0NNRGBKAPVENDNN    12
BKAP.LASTPURCH   0 51 16  0  0 0    8    0    0DNRGBKAPVENDNN     8
BKAP.LASTPMT     0 69 16  0  0 0    8    0    0DNRGBKAPVENDNN     8
\FILES
BKAPVENDBKAPVEND 28
\INCLUDE
\KEY
\\
\S5FORMAT2
  1Y  YSSREC_WORK     SDREC_WORK     SCREC_WORK     NONE          NONE          YNN

 Display Purchases By Date Range

   From       Thru      Num Orders   Total Dollars   Avg Purch




 All Purchases

 Press ESC to return to Main Vendor Screen














\FIELDS
FROM_DATE1       0  2  5  0  0 0    8    0    0DNNGMEMORY  NN     8
THRU_DATE1       0 13  5  0  0 0    8    0    0DNNGMEMORY  NN     8
PURCH_QTY1       0 28  5  0  0 0    3    0    0INNGMEMORY  NN     3
PURCH_TOT_DOL1   0 38  5  0  0 2   12    0    0NNNGMEMORY  NN    12
AVG_PURCH1       0 54  5  0  0 2   10    0    0NNNGMEMORY  NN    10
FROM_DATE2       0  2  6  0  0 0    8    0    0DNNGMEMORY  NN     8
THRU_DATE2       0 13  6  0  0 0    8    0    0DNNGMEMORY  NN     8
PURCH_QTY2       0 28  6  0  0 0    3    0    0INNGMEMORY  NN     3
PURCH_TOT_DOL2   0 38  6  0  0 2   12    0    0NNNGMEMORY  NN    12
AVG_PURCH2       0 54  6  0  0 2   10    0    0NNNGMEMORY  NN    10
FROM_DATE3       0  2  7  0  0 0    8    0    0DNNGMEMORY  NN     8
THRU_DATE3       0 13  7  0  0 0    8    0    0DNNGMEMORY  NN     8
PURCH_QTY3       0 28  7  0  0 0    3    0    0INNGMEMORY  NN     3
PURCH_TOT_DOL3   0 38  7  0  0 2   12    0    0NNNGMEMORY  NN    12
AVG_PURCH3       0 54  7  0  0 2   10    0    0NNNGMEMORY  NN    10
FROM_DATE4       0  2  8  0  0 0    8    0    0DNNGMEMORY  NN     8
THRU_DATE4       0 13  8  0  0 0    8    0    0DNNGMEMORY  NN     8
PURCH_QTY4       0 28  8  0  0 0    3    0    0INNGMEMORY  NN     3
PURCH_TOT_DOL4   0 38  8  0  0 2   12    0    0NNNGMEMORY  NN    12
AVG_PURCH4       0 54  8  0  0 2   10    0    0NNNGMEMORY  NN    10
ALL_PURCH_QTY    0 28  9  0  0 0    3    0    0INNGMEMORY  NN     3
ALL_PURCH_DOL    0 38  9  0  0 2   12    0    0NNNGMEMORY  NN    12
AVG_TOT_PURCH    0 54  9  0  0 2   10    0    0NNNGMEMORY  NN    10
\FILES
\INCLUDE
\KEY
\\
\B5FORMAT3
 13 80100 5 18        NNN!
                                Purch by Month                      Page:




                            Month    Gross Sales
                            -----    ------------

                                     ------------
                            Mth Tot:

                                     ============
                            Rpt Tot:
\FIELDS
PAGE_NUM         0 75  0  0  0 0    5    0    0INNGMEMORY  NN     5
BKAP.VENDCODE    0 35  1  0  0 0   10    0    0AYRGBKAPVEND      10
NAME_HLDR        0 27  2  0  0 0   25    0    0ANNGMEMORY  NN    25
DATE_TIME_FLD    0 26  3  0  0 0   28    0    0ANNGMEMORY  NN    28
YEAR_LONG        0 16  7  0  0 0   10    0    0ANNGMEMORY  NN    10
MONTH            0 29  7  0  0 0    3    0    0ANNGMEMORY  NN     3
PURCH.MTD        0 38  7  0  0 2   12    0    0NNNGMEMORY  NN    12
GROSS_MTD_SUBT   0 38  9  0  0 2   12    0    0NNNGMEMORY  NN    12
GROSS_TOTALS     0 38 12  0  0 2   12    0    0NNNGMEMORY  NN    12
\\
\S5FORMAT4
  1Y  YSSREC_BKAPADDR SDREC_BKAPADDR SCREC_BKAPADDR NONE          NONE          YNN

  Name:
  Add1:
  Add2:
   CSZ:
 Cntry:

  Use for:
\COLOR
   5  1  1 25 80
\FIELDS
BKAP.ADDR.NAME   0  9  2  0  0 0   30    0    0ANRGBKAPADDRNN    30
BKAP.ADDR.ADD1   0  9  3  0  0 0   30    0    0ANRGBKAPADDRNN    30
BKAP.ADDR.ADD2   0  9  4  0  0 0   30    0    0ANRGBKAPADDRNN    30
BKAP.ADDR.CITY   0  9  5  0  0 0   15    0    0ANRGBKAPADDRNN    15
BKAP.ADDR.STATE  0 25  5  0  0 0    2    0    0AYRGBKAPADDRNN     2
BKAP.ADDR.ZIP    0 29  5  0  0 0   10    0    0AYRGBKAPADDRNN    10
BKAP.ADDR.CNTRY  0  9  6  0  0 0   30    0    0ANRGBKAPADDRNN    30
BKAP.ADDR.COM    0 12  8  0  0 0   25    0    0ANRGBKAPADDRNN    25
\FILES
BKAPADDRBKAPADDR  8
\INCLUDE
\KEY
\\
\S5FORMAT5
  1Y  YSSREC_BKAPCONT SDREC_BKAPCONT SCREC_BKAPCONT NONE          NONE          YNN

  Contact Name:
 Telephone Num:
 Fax Phone Num:
     Loc/Title:
\COLOR
   5  1  1 25 80
\FIELDS
BKAP.CONT.NAME   0 18  2  0  0 0   25    0    0ANRGBKAPCONTNN    25
BKAP.CONT.PHONE  0 18  3  0  0 0   25    0    0AYRGBKAPCONTNN    25
BKAP.CONT.FAX    0 18  4  0  0 0   25    0    0AYRGBKAPCONTNN    25
BKAP.CONT.LOC    0 18  5  0  0 0   25    0    0ANRGBKAPCONTNN    25
\FILES
BKAPCONTBKAPCONT  4
\INCLUDE
\KEY
\\
