; Decompiled from 
; Fields: 134, Labels: 19, Instructions: 334

define RC type I size 3
define NORM_HLDR type I size 5
define FN_PATH type A size 47
define FN_PATH_HLDR type A size 47
define CREATE_LOC type A size 47
define DICT_FNAME type A size 8
define KEY_FNAME type A size 8
define LOC_FNAME type A size 8
define KNUM_FNAME type A size 8
define CREATE_FILE type A size 60
define CREATE_SPECS type A size 667
define CF_TITLE type A size 12
define CF_FLNAME type A size 8
define CF_FDNAME type A size 8
define CREATE_BUFF type A size 8
define CREATE_NAME type A size 8
define CF_FLCODE type A size 3
define CF_PATH type A size 40
define CF_DESC type A size 40
define CF_RTYPE type A size 1
define LOC_HNDL type I size 5
define KEY_HNDL type I size 5
define DICT_HNDL type I size 5
define KNUM_HNDL type I size 5
define SCRNH_1 type A size 4300
define CNTR type I size 5
define CNTR3 type I size 5
define CNTR4 type I size 5
define CNTR5 type I size 5
define TOT_REC_SIZE type I size 5
define DISPLAY type L size 3
define FILE_OPEN type L size 3
define XFR_LOCATION type A size 1 reset
define NEW type L size 3 reset
define REC_HLDR type R size 10
define KEY_LOC type I size 5
define KEY_FLAGS type I size 5
define KEY_EXTND type I size 5
define PAGE_SIZE type I size 5
define STRG_KEY type I size 5
define FILE_FLAGS type I size 5
define TOT_KEYS type I size 5
define DUP_KEYS type I size 5
define RMDR type I size 5
define RMDR_HLDR type I size 5
define TRS type I size 5
define LARGEST_KEY type I size 5
define TMP_HNDL type I size 5
define ACS_BUFFER type A size 258
define ACS_HNDL type I size 5
define ACS_HEADER type B size 3
define MIN_PAGE type I size 5
define DES_HNDL type I size 5
define IS_TYP type A size 1
define IS_SZE type I size 5
define BCD_DSIZE type I size 5
define BCD_ISIZE type I size 5
define COLOR_HNDL type I size 5 reset
define CPC_FLD type A size 60
define CPC_FLDS type I size 5
define CPC_LOC type I size 5

  udc LABEL_1
  RC = NORM
  NORM_HLDR = NORM
  param [CF_FLNAME, CF_FLCODE, FILE_OPEN, LOC_HNDL, KEY_HNDL, DICT_HNDL, KNUM_HNDL]
  trap CONST@49(binary) ?I:0
  if FILE_OPEN do
  ropen LOC_HNDL
  ropen KEY_HNDL
  ropen DICT_HNDL
  ropen KNUM_HNDL
  DISPLAY = .T.
  else
  FN_PATH = EXPR@60
  DICT_FNAME = 'FILEDICT'
  KEY_FNAME = 'FILEKEY'
  LOC_FNAME = 'FILELOC'
  KNUM_FNAME = 'FILEKNUM'
  gosub LABEL_2
  DISPLAY = .T.
LABEL_2:
  clrscr
  ? ,,['Advanced Accounting 5.0 Create/Initialize File Program']
  if EXPR@192 then
  ? ,,['Initializing file:', EXPR@278]
  trap CONST@339(binary) ?G:4
  if EXPR@341 do
  if NEW do
  clr LOC_HNDL
  CF_FDNAME = CF_FLNAME
  trap '%' ?G:5
  window 10 6 8 60 WC ' Create/Init File' 'l' 's' BC 'r' SC
  mount
  upar
  menu CF_FLNAME 89
  menu CF_FLCODE 89
  if EXPR@605 do
  findv LOC_HNDL key 2 val [EXPR@631] type M
  if EXPR@667 do
  CF_FDNAME = LOC_BUFF_NAME
  CF_PATH = LOC_LOCATION
  CF_DESC = LOC_DESCRIPTION
  CF_RTYPE = LOC_REC_TYPE
  CF_FLCODE = LOC_COMP_CODE
  menu CF_FDNAME 89
  if EXPR@839 do
  findv DICT_HNDL key 1 val [CF_FDNAME] type M
  if EXPR@878 do
  msg 'You must have records in the Data Dictionary defining this file.  Please enter these before trying to create the file.'
  goto LABEL_4
  menu CF_RTYPE 'TXFBD' 'This must be T, X, F, B or D' 89
  menu CF_PATH 89
  CF_PATH = EXPR@1150
  menu CF_DESC 78
  clrlne 25,1
  if EXPR@1202 do
  LOC_BUFF_NAME = CF_FDNAME
  LOC_FILE_NAME = CF_FLNAME
  LOC_COMP_CODE = CF_FLCODE
  LOC_LOCATION = CF_PATH
  LOC_DESCRIPTION = CF_DESC
  LOC_REC_TYPE = CF_RTYPE
  save LOC_HNDL
  else
  if EXPR@1255 do
  LOC_LOCATION = CF_PATH
  if EXPR@1285 then
  LOC_DESCRIPTION = CF_DESC
  save LOC_HNDL
  else
  if EXPR@1315 do
  LOC_DESCRIPTION = CF_DESC
  save LOC_HNDL
  CREATE_LOC = LOC_LOCATION
  CREATE_BUFF = LOC_BUFF_NAME
  CREATE_NAME = LOC_FILE_NAME
  if EXPR@1377 then
  CREATE_LOC = XFR_LOCATION
  rcn LOC_HNDL REC_HLDR
  gosub LABEL_10
LABEL_3:
  rscr
  clrscr
  quit
LABEL_5:
  func LABEL_6
  ? 25,1,[EXPR@1403, ' F2 - Display File Names', EXPR@1455]
  trap CONST@1495(binary) ?S:12
  ret .T.
LABEL_6:
  func LABEL_7
  trap CONST@1503(binary) ?D:0
  clrlne 25,1
  ret .T.
LABEL_7:
  func LABEL_8
  if NEW then
  ret .T.
  ? 25,1,[EXPR@1509, ' F2 - Display FD Names', EXPR@1560]
  trap CONST@1600(binary) ?S:13
  ret .T.
LABEL_11:
  saves SCRNH_1
  window 28 7 10 17 WC ' Files     CC' 'l' 's' BC 'r' SC
  listf [LOC_FILE_NAME, '', LOC_COMP_CODE] LOC_HNDL 2
  redsp SCRNH_1
  CF_FLNAME = LOC_FILE_NAME
  CF_FLCODE = LOC_COMP_CODE
  ret
LABEL_13:
  ret
LABEL_12:
  saves 
  window 28 7 10 13 WC ' File Desc' 'l' 's' BC 'r' SC
  listf [DICT_BUFF_NAME] DICT_HNDL 1 EXPR@1705
  redsp 
  if EXPR@1735 then
  CF_FDNAME = DICT_BUFF_NAME
  ret
LABEL_9:
  clrpe
  if DISPLAY do
  ? 15,12,['Creating file:', EXPR@1785]
  FILE_FLAGS = CONST@1896(I)
  fill CREATE_SPECS CONST@1899(I)
  DICT_BUFF_NAME = CREATE_BUFF
  DICT_OFFSET = CONST@1902(I)
  findv DICT_HNDL key 2 val  type M
  if EXPR@1908 do
  err EXPR@1997
  goto LABEL_15
  CNTR5 = CONST@2023(I)
  while EXPR@2026
  CNTR4 = EXPR@2052
  CNTR5 = EXPR@2130
  DICT_HOFFSET = DICT_OFFSET
  DICT_HTYPE = DICT_TYPE
  DICT_HSIZE = DICT_SIZE
  DICT_HDEC = DICT_DEC
  DICT_HARRAY = DICT_ARRAY_ELE
  save DICT_HNDL
  findv DICT_HNDL key 2 val  type N
  exit_if EXPR@2180
  endw
  TOT_REC_SIZE = CNTR5
  if EXPR@2227 do
  LOC_REC_SIZE = TOT_REC_SIZE
  save LOC_HNDL
  if EXPR@2352 do
  ask EXPR@2464
  if EXPR@2554 goto LABEL_4
  openv LOC_FILE_NAME cc LOC_COMP_CODE fnum TMP_HNDL
  close TMP_HNDL
  goto LABEL_4
  dall KNUM_HNDL
  clr KNUM_HNDL
  findv KEY_HNDL key 1 val [CREATE_BUFF] type M
  KEY_LOC = CONST@2648(I)
  TOT_KEYS = CONST@2651(I)
  DUP_KEYS = CONST@2654(I)
  LARGEST_KEY = CONST@2657(I)
  CNTR = CONST@2660(I)
  endw
  for CNTR =  to 24
  exit_if EXPR@2667
  if EXPR@2716 do
  KNUM_BUFF_NAME = KEY_BUFF_NAME
  KNUM_KEY_NAME = KEY_NAME[CNTR]
  KNUM_KEY_NUMB = KEY_NUM[CNTR]
  save KNUM_HNDL
  findv DICT_HNDL key 3 val [KEY_FIELD[CNTR]] type M
  if EXPR@2857 do
  err EXPR@2999
  goto LABEL_15
  DICT_OFFSET = EXPR@3058
  mid CREATE_SPECS = KEY_LOC,,DICT_OFFSET
  if EXPR@3099 do
  CNTR4 = EXPR@3218
  KEY_FLAGS = \0\x04\0NONEA\0\x1C\0\xFD`\0\0\0\x01\x85\0\0\0\0\0\nF\0\0\0\0C\xB4\f\0\00\0\0\0\xFFI
  if EXPR@3260 do
  KEY_FLAGS = EXPR@3295
  STRG_KEY = \0\0A\0\x01\0OA\0\x16\0\xFD0\0\0\0\0\aF\x10\x11\0\0C\xFF\f\0\0\0\0\0\0\xFFA\0\x18\0\xFD0
  KEY_EXTND = \0\x01\0OA\0\x16\0\xFD0\0\0\0\0\aF\x10\x11\0\0C\xFF\f\0\0\0\0\0\0\xFFA\0\x18\0\xFD0\0\0\0\v
  else
  if EXPR@3332 do
  CNTR4 = EXPR@3358
  KEY_FLAGS = \0\0A\0\x01\0NA\0\x16\0\xFD0\0\0\0\0\aF\x10\x11\0\0C@\r\0\0\0\0\0\0\xFFI\b\0I\x04\x01I
  KEY_EXTND = \0\x01\0NA\0\x16\0\xFD0\0\0\0\0\aF\x10\x11\0\0C@\r\0\0\0\0\0\0\xFFI\b\0I\x04\x01I\x02\0A
  else
  if EXPR@3397 do
  CNTR4 = CONST@3423(I,3365b)
  KEY_FLAGS = CONST@3426(I,3362b)
  KEY_EXTND = \0\x01\0IA\0\x01\0RA\06\0\xFD\x90\0\0\0\0\aF\x10\x11\0\0Ch\r\0\0\0\0\0\0\0\aF\x10\x11
  else
  if EXPR@3442 do
  CNTR4 = EXPR@3532
  KEY_FLAGS = CONST@3563(I,3225b)
  KEY_EXTND = \0\x01\0TA\0\x16\0\xFD0\0\0\0\0\aF\x10\x11\0\0C\xF1\r\0\0\0\0\0\0\xFFI\x04\0I\x04\x01I\x04\0A
  else
  if EXPR@3574 do
  CNTR4 = CONST@3600(I,3188b)
  KEY_FLAGS = CONST@3603(I,3185b)
  KEY_EXTND = \0\x01\0DA\0\x16\0\xFD0\0\0\0\0\aF\x10\x11\0\0C\x19\x0E\0\0\0\0\0\0\xFFI\x04\0I\x04\x01I\x03\0A
  else
  if EXPR@3614 do
  CNTR4 = CONST@3640(I,3148b)
  KEY_FLAGS = CONST@3643(I,3145b)
  KEY_EXTND = \02\0 is a pointer or a byte field and can
  else
  err EXPR@3703
  goto LABEL_15
  LARGEST_KEY = EXPR@3743
  mid CREATE_SPECS = EXPR@3781,,CNTR4
  if EXPR@3812 do
  KEY_FLAGS = EXPR@3855
  inc DUP_KEYS
  KEY_FLAGS = EXPR@3910
  KEY_FLAGS = EXPR@3995
  KEY_FLAGS = EXPR@4080
  KEY_FLAGS = EXPR@4165
  mid CREATE_SPECS = EXPR@4233,,KEY_FLAGS
  mid CREATE_SPECS = EXPR@4262,,KEY_EXTND
  KEY_LOC = EXPR@4291
  inc TOT_KEYS
  endw
  PAGE_SIZE = CONST@4317(I,2471b)
  RMDR_HLDR = PAGE_SIZE
  MIN_PAGE = CONST@4320(I,2468b)
  if EXPR@4326 then
  MIN_PAGE = CONST@4352(I,2436b)
  CNTR = CONST@4355(I,2433b)
  endw
  for CNTR =  to MIN_PAGE step -1
  if EXPR@4367 do
  CNTR5 = EXPR@4447
  PAGE_SIZE = CONST@4489(I,2299b)
  FILE_FLAGS = \0\x02I\b\0I\x06\0A\0V\0\xFD\xF0\0\0\0\0\x03F\x80\n\0\0C\x8F\x11\0\0\0\0\0\0\0\x03C\x92\x11
  else
  exit_if EXPR@4504
  exit_if EXPR@4606
  RMDR = EXPR@4779
  if EXPR@4838 do
  RMDR_HLDR = RMDR
  PAGE_SIZE = EXPR@4867
  endw
  if EXPR@4902 then
  PAGE_SIZE = \0\x01\0.A\06\0\xFD\x90\0\0\0\0\x03F\x90\x06\0\0F\xA0\b\0\0\0\0\0\0\0\x03F\0\0\0\0Cs\x13
  mid CREATE_SPECS = 1,,CNTR5
  mid CREATE_SPECS = 3,,PAGE_SIZE
  mid CREATE_SPECS = 5,,KEY_NUMKEYS
  mid CREATE_SPECS = 11,,FILE_FLAGS
  CREATE_FILE = EXPR@4984
  openv 'filedes' cc 'B' fnum DES_HNDL
  findv DES_HNDL key 1 val [LOC_BUFF_NAME] type M
  if EXPR@5087 do
  DES_FD_NAME = LOC_BUFF_NAME
  xfer CREATE_SPECS to DES_INFORMATION
  save DES_HNDL
  close DES_HNDL
  inifle CREATE_FILE
  rcn LOC_HNDL REC_HLDR
  LOC_REC_SIZE = TOT_REC_SIZE
  save LOC_HNDL
LABEL_14:
  goto LABEL_4
LABEL_4:
  trap CONST@5128(binary) ?G:18
  saves SCRNH_1
  clrsf
  ? 23,1,['Enter the path:']
  say 17,FN_PATH,23
LABEL_18:
  upar
  menu FN_PATH 89
  if EXPR@5160 goto LABEL_18
  FN_PATH = EXPR@5191
  if EXPR@5278 do
  ask EXPR@5412 .T.
  if EXPR@5458 do
  gosub LABEL_2
LABEL_17:
  clrsf
  redsp SCRNH_1
  goto LABEL_3
LABEL_15:
  func LABEL_16
  if EXPR@5510 do
  ret IS_SZE
  else
  if EXPR@5541 do
  ret \0\x01\0LA\0\x01\0BA\06\0\xFD\x90\0\0\0\0\aF\xE0\x16\0\0C\xC2\x15\0\0\0\0\0\0\0\aF\xE0\x16
  else
  if EXPR@5580 do
  ret \0\x01\0NA\0\x16\0\xFD0\0\0\0\0\aF\xE0\x16\0\0C\t\x16\0\0\0\0\0\0\xFFI\b\0A\0\x01\0DA
  else
  if EXPR@5646 do
  ret \0\x01\0DA\0\x01\0TA\0\x01\0RA\0V\0\xFD\xF0\0\0\0\0\aF\xE0\x16\0\0C+\x16
  else
  if EXPR@5690 do
  ret \0\x01\0PA\0\x16\0\xFD0\0\0\0\0\aF\xE0\x16\0\0C\x97\x16\0\0\0\0\0\0\xFFI\n\0A\0\x01\0FA
  else
  if EXPR@5788 do
  ret \0\x01\0FA\0\x16\0\xFD0\0\0\0\0\aF\xE0\x16\0\0C\xB9\x16\0\0\0\0\0\0\xFFI\x03\0A\0\x01\0OA
  else
  if EXPR@5822 do
  ret \0\x01\0OA\0\x16\0\xFD0\0\0\0\0\aF\xE0\x16\0\0C\xDB\x16\0\0\0\0\0\0\xFFA\0\x18\0\xFD0\0\0\0\v
  else
  if EXPR@5856 do
  ret EXPR@5882
  else
  ret \0\x06\0F@\x17\0\0\0I\x02\0A\0\x16\0\xFD0\0\0\0\0\x04F@\x17\0\0C#\x17\0\0\0\0\0\0\xFFI\x02
LABEL_16:
  func LABEL_17
  BCD_ISIZE = EXPR@5926
  if EXPR@5955 then
  inc BCD_ISIZE
  ret BCD_ISIZE
LABEL_1:
  if EXPR@6000 then
  close DICT_HNDL
  openv DICT_FNAME cc 'B' fnum DICT_HNDL
  if EXPR@6050 then
  close KEY_HNDL
  openv KEY_FNAME cc 'B' fnum KEY_HNDL
  if EXPR@6100 then
  close LOC_HNDL
  openv LOC_FNAME cc 'B' fnum LOC_HNDL
  if EXPR@6150 then
  close KNUM_HNDL
  openv KNUM_FNAME cc 'B' fnum KNUM_HNDL
  ret
  quit
LABEL_0:
  cmd LABEL_1
  if EXPR@6389 do
  if EXPR@6440 do
  openv 'tascolor.ovl' fnum COLOR_HNDL
  else
  openv 'tascolor.ovl' fnum COLOR_HNDL
  findv COLOR_HNDL key  val  type F
  else
  ropen COLOR_HNDL
  color NORM
  ret
LABEL_8:
  func LABEL_9
  CPC_LOC = EXPR@6550
  if EXPR@6584 do
  mid CPC_FLD = EXPR@6735,,'\'
  ret CPC_FLD
LABEL_10:
  func LABEL_11
  ret EXPR@6771
  ; UNK_65024 (spec=0 bytes)
